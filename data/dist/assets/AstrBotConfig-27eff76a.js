import{V as St}from"./index-2a23493b.js";import{u as tt,v as V,c as ie,x as Ae,o as a,g as f,A as $,b as t,a5 as _e,t as i,f as u,F as Q,h as ve,a as _,w as e,e as o,k as Ye,p as O,B as T,y as me,z as Pe,C as ce,aq as ht,l as Y,O as qe,V as $e,Q as Fe,d as he,H as ke,I as pe,J as Ve,aZ as Dt,al as Ee,am as ue,bh as xt,s as It,ay as st,a3 as Me,n as At,D as Ct,R as vt,S as ft,ap as ut,m as Ze,aw as Ut,b0 as Bt,ae as ot,aD as Kt,aE as at,aI as Zt,aJ as Qt,G as ct,q as xe,as as Lt,bi as Xt,M as el,aR as kt,K as se,aC as Nt,_ as tl,ak as ll,Z as bt,bc as al,bd as ol,be as il,bf as nl,a1 as pt,aj as sl,ah as dl,ai as _t,ao as Ft,aL as Vt,aM as wt,aT as rl,an as Mt,$ as ul,a0 as cl,bj as ml,r as vl,aN as fl}from"./index-61371d60.js";import{_ as Ue}from"./_plugin-vue_export-helper-c27b6911.js";import{P as pl}from"./PersonaForm-76e4f5a1.js";const gl={class:"d-flex align-center justify-space-between ga-2"},yl={key:0,class:"flex-grow-1 d-flex align-center ga-2"},hl={key:1},bl={key:0,style:{color:"rgb(var(--v-theme-primaryText))"}},_l={key:1,class:"d-flex flex-wrap ga-2"},xl={class:"d-flex align-center ga-2"},kl={class:"d-flex"},Vl={key:1,class:"text-center py-8"},wl={class:"text-grey mt-4"},Sl={__name:"ListConfigItem",props:{modelValue:{type:Array,default:()=>[]},label:{type:String,default:""},buttonText:{type:String,default:"ä¿®æ”¹"},dialogTitle:{type:String,default:"ä¿®æ”¹åˆ—è¡¨é¡¹"},maxDisplayItems:{type:Number,default:1},preferSingleItem:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(l,{emit:h}){const n=l,{t:g}=tt(),s=V(!1),y=V([]),k=V([]),p=V(""),m=V(-1),q=V(""),x=V(!1),G=V(""),A=ie(()=>{var b;return(((b=n.modelValue)==null?void 0:b.length)??0)<=1&&n.preferSingleItem}),N=ie({get:()=>{var b;return((b=n.modelValue)==null?void 0:b[0])??""},set:b=>{const d=[...n.modelValue||[]];d.length===0?d.push(b):d[0]=b,h("update:modelValue",d)}}),B=ie(()=>n.modelValue.slice(0,n.maxDisplayItems)),H=ie(()=>G.value?G.value.split(`
`).map(b=>b.trim()).filter(b=>b.length>0).length:0);Ae(()=>n.modelValue,b=>{y.value=[...b||[]]},{immediate:!0});function j(){y.value=[...n.modelValue||[]],k.value=[...n.modelValue||[]],s.value=!0,m.value=-1,q.value="",p.value=""}function C(){p.value.trim()!==""&&(y.value.push(p.value.trim()),p.value="")}function S(b){y.value.splice(b,1)}function E(b,d){m.value=b,q.value=d}function L(){q.value.trim()!==""&&(y.value[m.value]=q.value.trim(),I())}function I(){m.value=-1,q.value=""}function U(){h("update:modelValue",[...y.value]),s.value=!1}function v(){y.value=[...k.value],m.value=-1,q.value="",p.value="",s.value=!1}function K(){if(G.value.trim()){const b=G.value.split(`
`).map(d=>d.trim()).filter(d=>d.length>0);y.value.push(...b),G.value="",x.value=!1}}function r(){G.value="",x.value=!1}return(b,d)=>(a(),f(Q,null,[$("div",gl,[A.value?(a(),f("div",yl,[t(_e,{modelValue:N.value,"onUpdate:modelValue":d[0]||(d[0]=w=>N.value=w),"hide-details":"",variant:"outlined",density:"compact",class:"flex-grow-1"},null,8,["modelValue"])])):(a(),f("div",hl,[!l.modelValue||l.modelValue.length===0?(a(),f("span",bl,i(u(g)("core.common.list.noItems")),1)):(a(),f("div",_l,[(a(!0),f(Q,null,ve(B.value,w=>(a(),_(Ye,{key:w,size:"x-small",label:"",color:"primary"},{default:e(()=>[o(i(w.length>20?w.slice(0,20)+"...":w),1)]),_:2},1024))),128)),l.modelValue.length>l.maxDisplayItems?(a(),_(Ye,{key:0,size:"x-small",label:"",color:"grey-lighten-1"},{default:e(()=>[o(" +"+i(l.modelValue.length-l.maxDisplayItems),1)]),_:1})):O("",!0)]))])),t(T,{size:"small",color:"primary",variant:"tonal",onClick:j},{default:e(()=>[o(i(l.preferSingleItem?u(g)("core.common.list.addMore"):l.buttonText||u(g)("core.common.list.modifyButton")),1)]),_:1})]),t(Ve,{modelValue:s.value,"onUpdate:modelValue":d[5]||(d[5]=w=>s.value=w),"max-width":"600px"},{default:e(()=>[t(me,null,{default:e(()=>[t(Pe,{class:"text-h3 py-4",style:{"font-weight":"normal"}},{default:e(()=>[o(i(l.dialogTitle||u(g)("core.common.list.editTitle")),1)]),_:1}),t(ce,{class:"pa-4 pb-2"},{default:e(()=>[$("div",xl,[t(_e,{modelValue:p.value,"onUpdate:modelValue":d[1]||(d[1]=w=>p.value=w),label:u(g)("core.common.list.addItemPlaceholder"),onKeyup:ht(C,["enter"]),clearable:"","hide-details":"",variant:"outlined",density:"compact",placeholder:u(g)("core.common.list.inputPlaceholder"),class:"flex-grow-1"},null,8,["modelValue","label","onKeyup","placeholder"]),t(T,{onClick:C,variant:"tonal",color:"primary",size:"small",disabled:!p.value.trim()},{default:e(()=>[o(i(u(g)("core.common.list.addButton")),1)]),_:1},8,["disabled"]),t(T,{onClick:d[2]||(d[2]=w=>x.value=!0),variant:"tonal",color:"primary",size:"small"},{default:e(()=>[t(Y,{size:"small"},{default:e(()=>[o("mdi-import")]),_:1}),o(" "+i(u(g)("core.common.list.batchImport")),1)]),_:1})])]),_:1}),t(ce,{class:"pa-0",style:{"max-height":"400px","overflow-y":"auto"}},{default:e(()=>[y.value.length>0?(a(),_(qe,{key:0,density:"compact"},{default:e(()=>[(a(!0),f(Q,null,ve(y.value,(w,D)=>(a(),_($e,{key:D,rounded:"md",class:"ma-1 list-item-clickable",onClick:ge=>E(D,w)},{append:e(()=>[$("div",kl,[m.value===D?(a(),_(T,{key:0,onClick:Fe(L,["stop"]),variant:"plain",color:"success",icon:"",size:"small"},{default:e(()=>[t(Y,null,{default:e(()=>[o("mdi-check")]),_:1})]),_:1},8,["onClick"])):O("",!0),t(T,{onClick:Fe(ge=>m.value===D?I():S(D),["stop"]),variant:"plain",color:m.value===D?"error":"default",icon:"",size:"small"},{default:e(()=>[t(Y,null,{default:e(()=>[o("mdi-close")]),_:1})]),_:2},1032,["onClick","color"])])]),default:e(()=>[m.value!==D?(a(),_(he,{key:0,class:"item-text"},{default:e(()=>[o(i(w),1)]),_:2},1024)):(a(),_(_e,{key:1,modelValue:q.value,"onUpdate:modelValue":d[3]||(d[3]=ge=>q.value=ge),"hide-details":"",variant:"outlined",density:"compact",onKeyup:[ht(L,["enter"]),ht(I,["esc"])],onClick:d[4]||(d[4]=Fe(()=>{},["stop"])),autofocus:""},null,8,["modelValue","onKeyup"]))]),_:2},1032,["onClick"]))),128))]),_:1})):(a(),f("div",Vl,[t(Y,{size:"64",color:"grey-lighten-1"},{default:e(()=>[o("mdi-format-list-bulleted")]),_:1}),$("p",wl,i(u(g)("core.common.list.noItemsHint")),1)]))]),_:1}),t(ke,{class:"pa-4"},{default:e(()=>[t(pe),t(T,{variant:"text",onClick:v},{default:e(()=>[o(i(u(g)("core.common.cancel")),1)]),_:1}),t(T,{color:"primary",onClick:U},{default:e(()=>[o(i(u(g)("core.common.confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Ve,{modelValue:x.value,"onUpdate:modelValue":d[7]||(d[7]=w=>x.value=w),"max-width":"600px"},{default:e(()=>[t(me,null,{default:e(()=>[t(Pe,{class:"text-h3 py-4",style:{"font-weight":"normal"}},{default:e(()=>[o(i(u(g)("core.common.list.batchImportTitle")),1)]),_:1}),t(ce,null,{default:e(()=>[t(Dt,{modelValue:G.value,"onUpdate:modelValue":d[6]||(d[6]=w=>G.value=w),label:u(g)("core.common.list.batchImportLabel"),placeholder:u(g)("core.common.list.batchImportPlaceholder"),rows:"10",variant:"outlined",hint:u(g)("core.common.list.batchImportHint"),"persistent-hint":""},null,8,["modelValue","label","placeholder","hint"])]),_:1}),t(ke,{class:"pa-4"},{default:e(()=>[t(pe),t(T,{variant:"text",onClick:r},{default:e(()=>[o(i(u(g)("core.common.cancel")),1)]),_:1}),t(T,{color:"primary",onClick:K},{default:e(()=>[o(i(u(g)("core.common.list.batchImportButton",{count:H.value})),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Cl=Ue(Sl,[["__scopeId","data-v-8a03e41f"]]);const Jt=l=>(vt("data-v-e0bd03f1"),l=l(),ft(),l),Pl={class:"d-flex align-center justify-space-between"},$l={key:0,style:{color:"rgb(var(--v-theme-primaryText))"}},Tl={key:1,class:"d-flex flex-wrap ga-2"},Il={key:0},Ul={key:1,class:"d-flex align-center gap-2 flex-grow-1"},jl={key:1,class:"mt-4"},El=Jt(()=>$("div",{class:"text-caption text-grey mb-2"},"é¢„è®¾",-1)),zl={class:"d-flex flex-column"},Ol={class:"text-caption font-weight-medium"},Dl={key:0,class:"text-caption text-grey",style:{"font-size":"0.7rem"}},Al={key:1,class:"d-flex align-center ga-4 flex-grow-1"},Bl={key:2,class:"text-center py-8"},Kl=Jt(()=>$("p",{class:"text-grey mt-4"},"æš‚æ— å‚æ•°",-1)),Ll={class:"d-flex align-center ga-2"},Nl={__name:"ObjectEditor",props:{modelValue:{type:Object,required:!0},itemMeta:{type:Object,default:null},buttonText:{type:String,default:"ä¿®æ”¹"},dialogTitle:{type:String,default:"ä¿®æ”¹é”®å€¼å¯¹"},maxDisplayItems:{type:Number,default:1}},emits:["update:modelValue"],setup(l,{emit:h}){const n=l;tt();const g=V(!1),s=V([]),y=V([]),k=V(""),p=V("string"),m=ie(()=>{var r;return((r=n.itemMeta)==null?void 0:r.template_schema)||{}}),q=ie(()=>Object.keys(m.value).length>0),x=ie(()=>Object.keys(n.modelValue).slice(0,n.maxDisplayItems)),G=ie(()=>s.value.filter(r=>!m.value[r.key]));Ae(()=>n.modelValue,r=>{},{immediate:!0});function A(){s.value=[];for(const[r,b]of Object.entries(n.modelValue)){let d=typeof b=="object"?"json":typeof b,w=d==="json"?JSON.stringify(b):b;const D=m.value[r];D&&(d=D.type||d,w==null&&(w=D.default!==void 0?D.default:w)),s.value.push({key:r,value:w,type:d,slider:D==null?void 0:D.slider,template:D})}}function N(){A(),y.value=JSON.parse(JSON.stringify(s.value)),k.value="",p.value="string",g.value=!0}function B(){const r=k.value.trim();if(r!==""){if(s.value.some(w=>w.key===r)){alert("é”®åå·²å­˜åœ¨");return}let d;switch(p.value){case"number":d=0;break;case"boolean":d=!1;break;case"json":d="{}";break;default:d="";break}s.value.push({key:r,value:d,type:p.value}),k.value=""}}function H(r,b){try{JSON.parse(b),s.value[r].jsonError=""}catch{s.value[r].jsonError="JSON æ ¼å¼é”™è¯¯"}}function j(r){const b=s.value.findIndex(d=>d.key===r);b>=0&&s.value.splice(b,1)}function C(r,b){const d=s.value[r].key;if(d===b)return;if(s.value.some((ge,Te)=>Te!==r&&ge.key===b)){alert("é”®åå·²å­˜åœ¨"),s.value[r].key=d;return}const D=m.value[b];D?(s.value[r].type=D.type||s.value[r].type,(s.value[r].value===void 0||s.value[r].value===null||s.value[r].value==="")&&(s.value[r].value=D.default!==void 0?D.default:s.value[r].value),s.value[r].slider=D.slider,s.value[r].template=D):(s.value[r].slider=void 0,s.value[r].template=void 0),s.value[r].key=b}function S(r){return s.value.some(b=>b.key===r)}function E(r){const b=s.value.find(w=>w.key===r);if(b)return b.value;const d=m.value[r];return(d==null?void 0:d.default)!==void 0?d.default:U((d==null?void 0:d.type)||"string")}function L(r,b){const d=s.value.findIndex(D=>D.key===r),w=m.value[r];if(d>=0)s.value[d].value=b;else{let D=(w==null?void 0:w.type)||"string";s.value.push({key:r,value:b,type:D,slider:w==null?void 0:w.slider,template:w})}}function I(r){const b=s.value.findIndex(d=>d.key===r);b>=0&&s.value.splice(b,1)}function U(r){switch(r){case"int":case"float":case"number":return 0;case"bool":case"boolean":return!1;case"json":return"{}";case"string":default:return""}}function v(){const r={};for(const b of s.value){if(b.type==="json"&&b.jsonError)return;let d=b.value;switch(b.type){case"int":d=parseInt(b.value)||0;break;case"float":case"number":d=Number(b.value);break;case"bool":case"boolean":break;case"json":d=JSON.parse(b.value);break;case"string":default:d=String(b.value);break}r[b.key]=d}h("update:modelValue",r),g.value=!1}function K(){s.value=JSON.parse(JSON.stringify(y.value)),g.value=!1}return(r,b)=>(a(),f(Q,null,[$("div",Pl,[$("div",null,[!l.modelValue||Object.keys(l.modelValue).length===0?(a(),f("span",$l," æš‚æ— é¡¹ç›® ")):(a(),f("div",Tl,[(a(!0),f(Q,null,ve(x.value,d=>(a(),_(Ye,{key:d,size:"x-small",label:"",color:"primary"},{default:e(()=>[o(i(d.length>20?d.slice(0,20)+"...":d),1)]),_:2},1024))),128)),Object.keys(l.modelValue).length>l.maxDisplayItems?(a(),_(Ye,{key:0,size:"x-small",label:"",color:"grey-lighten-1"},{default:e(()=>[o(" +"+i(Object.keys(l.modelValue).length-l.maxDisplayItems),1)]),_:1})):O("",!0)]))]),t(T,{size:"small",color:"primary",variant:"tonal",onClick:N},{default:e(()=>[o(i(l.buttonText),1)]),_:1})]),t(Ve,{modelValue:g.value,"onUpdate:modelValue":b[2]||(b[2]=d=>g.value=d),"max-width":"600px"},{default:e(()=>[t(me,null,{default:e(()=>[t(Pe,{class:"text-h3 py-4",style:{"font-weight":"normal"}},{default:e(()=>[o(i(l.dialogTitle),1)]),_:1}),t(ce,{class:"pa-4",style:{"max-height":"400px","overflow-y":"auto"}},{default:e(()=>[G.value.length>0?(a(),f("div",Il,[(a(!0),f(Q,null,ve(G.value,(d,w)=>(a(),f("div",{key:w,class:"key-value-pair"},[t(Ee,{"no-gutters":"",align:"center",class:"mb-2"},{default:e(()=>[t(ue,{cols:"4"},{default:e(()=>[t(_e,{modelValue:d.key,"onUpdate:modelValue":D=>d.key=D,density:"compact",variant:"outlined","hide-details":"",placeholder:"é”®å",onBlur:D=>C(w,d.key)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),_:2},1024),t(ue,{cols:"7",class:"pl-2 d-flex align-center justify-end"},{default:e(()=>[d.type==="string"?(a(),_(_e,{key:0,modelValue:d.value,"onUpdate:modelValue":D=>d.value=D,density:"compact",variant:"outlined","hide-details":"",placeholder:"å­—ç¬¦ä¸²å€¼"},null,8,["modelValue","onUpdate:modelValue"])):d.type==="number"||d.type==="float"||d.type==="int"?(a(),f("div",Ul,[d.slider?(a(),_(xt,{key:0,"model-value":Number(d.value)||0,"onUpdate:modelValue":D=>d.value=D,min:d.slider.min,max:d.slider.max,step:d.slider.step,color:"primary",density:"compact","hide-details":"",class:"flex-grow-1"},null,8,["model-value","onUpdate:modelValue","min","max","step"])):O("",!0),t(_e,{modelValue:d.value,"onUpdate:modelValue":D=>d.value=D,modelModifiers:{number:!0},type:"number",density:"compact",variant:"outlined","hide-details":"",placeholder:"æ•°å€¼",style:It(d.slider?"max-width: 120px;":"")},null,8,["modelValue","onUpdate:modelValue","style"])])):d.type==="boolean"?(a(),_(st,{key:2,modelValue:d.value,"onUpdate:modelValue":D=>d.value=D,density:"compact","hide-details":"",color:"primary"},null,8,["modelValue","onUpdate:modelValue"])):O("",!0),d.type==="json"?(a(),_(_e,{key:3,modelValue:d.value,"onUpdate:modelValue":D=>d.value=D,density:"compact",variant:"outlined","hide-details":"auto",placeholder:"JSON",onBlur:D=>H(w,d.value),"error-messages":d.jsonError},null,8,["modelValue","onUpdate:modelValue","onBlur","error-messages"])):O("",!0)]),_:2},1024),t(ue,{cols:"1",class:"pl-2"},{default:e(()=>[t(T,{icon:"",variant:"text",size:"small",color:"error",onClick:D=>j(d.key)},{default:e(()=>[t(Y,null,{default:e(()=>[o("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))])):O("",!0),q.value?(a(),f("div",jl,[t(Me,{class:"mb-3"}),El,(a(!0),f(Q,null,ve(m.value,(d,w)=>(a(),f("div",{key:w,class:At(["template-field",{"template-field-inactive":!S(w)}])},[t(Ee,{"no-gutters":"",align:"center",class:"mb-2"},{default:e(()=>[t(ue,{cols:"4"},{default:e(()=>[$("div",zl,[$("span",Ol,i(d.name||d.description||w),1),d.hint?(a(),f("span",Dl,i(d.hint),1)):O("",!0)])]),_:2},1024),t(ue,{cols:"7",class:"pl-2 d-flex align-center justify-end"},{default:e(()=>[d.type==="string"?(a(),_(_e,{key:0,"model-value":E(w),"onUpdate:modelValue":D=>L(w,D),density:"compact",variant:"outlined","hide-details":"",placeholder:"å­—ç¬¦ä¸²å€¼"},null,8,["model-value","onUpdate:modelValue"])):d.type==="number"||d.type==="float"||d.type==="int"?(a(),f("div",Al,[d.slider?(a(),_(xt,{key:0,"model-value":Number(E(w))||0,"onUpdate:modelValue":D=>L(w,D),min:d.slider.min,max:d.slider.max,step:d.slider.step,color:"primary",density:"compact","hide-details":"",class:"flex-grow-1"},null,8,["model-value","onUpdate:modelValue","min","max","step"])):O("",!0),t(_e,{"model-value":E(w),"onUpdate:modelValue":D=>L(w,D),type:"number",density:"compact",variant:"outlined","hide-details":"",placeholder:"æ•°å€¼",style:It(d.slider?"max-width: 120px;":"")},null,8,["model-value","onUpdate:modelValue","style"])])):d.type==="boolean"||d.type==="bool"?(a(),_(st,{key:2,"model-value":E(w),"onUpdate:modelValue":D=>L(w,D),density:"compact","hide-details":"",color:"primary"},null,8,["model-value","onUpdate:modelValue"])):O("",!0)]),_:2},1024),t(ue,{cols:"1",class:"pl-2"},{default:e(()=>[S(w)?(a(),_(T,{key:0,icon:"",variant:"text",size:"small",color:"error",onClick:D=>I(w)},{default:e(()=>[t(Y,null,{default:e(()=>[o("mdi-close")]),_:1})]),_:2},1032,["onClick"])):O("",!0)]),_:2},1024)]),_:2},1024)],2))),128))])):O("",!0),s.value.length===0&&!q.value?(a(),f("div",Bl,[t(Y,{size:"64",color:"grey-lighten-1"},{default:e(()=>[o("mdi-code-json")]),_:1}),Kl])):O("",!0)]),_:1}),t(ce,{class:"pa-4"},{default:e(()=>[$("div",Ll,[t(_e,{modelValue:k.value,"onUpdate:modelValue":b[0]||(b[0]=d=>k.value=d),label:"æ–°é”®å",density:"compact",variant:"outlined","hide-details":"",class:"flex-grow-1"},null,8,["modelValue"]),t(Ct,{modelValue:p.value,"onUpdate:modelValue":b[1]||(b[1]=d=>p.value=d),items:["string","number","boolean","json"],label:"å€¼ç±»å‹",density:"compact",variant:"outlined","hide-details":"",style:{"max-width":"120px"}},null,8,["modelValue"]),t(T,{onClick:B,variant:"tonal",color:"primary"},{default:e(()=>[t(Y,null,{default:e(()=>[o("mdi-plus")]),_:1}),o(" æ·»åŠ  ")]),_:1})])]),_:1}),t(ke,{class:"pa-4"},{default:e(()=>[t(pe),t(T,{variant:"text",onClick:K},{default:e(()=>[o("å–æ¶ˆ")]),_:1}),t(T,{color:"primary",onClick:v},{default:e(()=>[o("ç¡®è®¤")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Fl=Ue(Nl,[["__scopeId","data-v-e0bd03f1"]]);const Ml={name:"ItemCard",setup(){const{t:l}=tt();return{t:l}},props:{item:{type:Object,required:!0},titleField:{type:String,default:"id"},enabledField:{type:String,default:"enable"},bglogo:{type:String,default:null},loading:{type:Boolean,default:!1},showCopyButton:{type:Boolean,default:!1}},emits:["toggle-enabled","delete","edit","copy"],methods:{getItemTitle(){return this.item[this.titleField]},getItemEnabled(){return this.item[this.enabledField]},toggleEnabled(){this.$emit("toggle-enabled",this.item)}}},Jl=["title"],Rl={key:0,class:"d-flex justify-end align-center",style:{position:"absolute",bottom:"16px",right:"16px",opacity:"0.2"}};function ql(l,h,n,g,s,y){return a(),_(me,{class:"item-card hover-elevation",style:{padding:"4px"},elevation:"0"},{default:e(()=>[t(Pe,{class:"d-flex justify-space-between align-center pb-1 pt-3"},{default:e(()=>[$("span",{class:"text-h2 text-truncate",title:y.getItemTitle()},i(y.getItemTitle()),9,Jl),t(ut,{location:"top"},{activator:e(({props:k})=>[t(st,Ze({color:"primary","hide-details":"",density:"compact","model-value":y.getItemEnabled(),loading:n.loading,disabled:n.loading},k,{"onUpdate:modelValue":y.toggleEnabled}),null,16,["model-value","loading","disabled","onUpdate:modelValue"])]),default:e(()=>[$("span",null,i(y.getItemEnabled()?g.t("core.common.itemCard.enabled"):g.t("core.common.itemCard.disabled")),1)]),_:1})]),_:1}),t(ce,null,{default:e(()=>[Ut(l.$slots,"item-details",{item:n.item},void 0,!0)]),_:3}),t(ke,{style:{margin:"8px"}},{default:e(()=>[t(T,{variant:"outlined",color:"error",size:"small",rounded:"xl",disabled:n.loading,onClick:h[0]||(h[0]=k=>l.$emit("delete",n.item))},{default:e(()=>[o(i(g.t("core.common.itemCard.delete")),1)]),_:1},8,["disabled"]),t(T,{variant:"tonal",color:"primary",size:"small",rounded:"xl",disabled:n.loading,onClick:h[1]||(h[1]=k=>l.$emit("edit",n.item))},{default:e(()=>[o(i(g.t("core.common.itemCard.edit")),1)]),_:1},8,["disabled"]),n.showCopyButton?(a(),_(T,{key:0,variant:"tonal",color:"secondary",size:"small",rounded:"xl",disabled:n.loading,onClick:h[2]||(h[2]=k=>l.$emit("copy",n.item))},{default:e(()=>[o(i(g.t("core.common.itemCard.copy")),1)]),_:1},8,["disabled"])):O("",!0),Ut(l.$slots,"actions",{item:n.item},void 0,!0),t(pe)]),_:3}),n.bglogo?(a(),f("div",Rl,[t(Bt,{src:n.bglogo,contain:"",width:"120",height:"120"},null,8,["src"])])):O("",!0)]),_:3})}const Hl=Ue(Ml,[["render",ql],["__scopeId","data-v-e885d0e6"]]);function Pt(l){return{openai:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/openai.svg",azure:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/azure.svg",xai:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/xai.svg",anthropic:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/anthropic.svg",ollama:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/ollama.svg",google:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/gemini-color.svg",deepseek:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/deepseek.svg",modelscope:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/modelscope.svg",zhipu:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/zhipu.svg",siliconflow:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/siliconcloud.svg",moonshot:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/kimi.svg",ppio:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/ppio.svg",dify:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/dify-color.svg",coze:"https://registry.npmmirror.com/@lobehub/icons-static-svg/1.66.0/files/icons/coze.svg",dashscope:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/alibabacloud-color.svg",fastgpt:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/fastgpt-color.svg",lm_studio:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/lmstudio.svg",fishaudio:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/fishaudio.svg",minimax:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/minimax.svg","302ai":"https://registry.npmmirror.com/@lobehub/icons-static-svg/1.53.0/files/icons/ai302-color.svg",microsoft:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/microsoft.svg",vllm:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/vllm.svg",groq:"https://registry.npmmirror.com/@lobehub/icons-static-svg/latest/files/icons/groq.svg",modelstack:new URL("/assets/modelstack-8f93c647.svg",self.location).href,tokenpony:"https://tokenpony.cn/tokenpony-web/logo.png",compshare:"https://compshare.cn/favicon.ico"}[l]||""}function Wl(l,h,n){return h=="OpenAI"?n("providers.description.openai",{type:l.type}):h=="vLLM Rerank"?n("providers.description.vllm_rerank",{type:l.type}):n("providers.description.default",{type:l.type})}const Gl={name:"AddNewProvider",props:{show:{type:Boolean,default:!1},metadata:{type:Object,default:()=>({})}},emits:["update:show","select-template"],setup(){const{tm:l}=ot("features/provider");return{tm:l}},data(){return{activeProviderTab:"chat_completion"}},computed:{showDialog:{get(){return this.show},set(l){this.$emit("update:show",l)}}},methods:{closeDialog(){this.showDialog=!1},getTemplatesByType(l){const h=this.metadata.provider.config_template||{},n={};for(const[g,s]of Object.entries(h))s.provider_type===l&&(n[g]=s);return n},getProviderIcon:Pt,getProviderDescription(l,h){return Wl(l,h,this.tm)},selectProviderTemplate(l){this.$emit("select-template",l),this.closeDialog()}}},Yl={class:"provider-card-content"},Zl={class:"provider-card-text"},Ql={class:"provider-card-logo"},Xl=["src"],ea={key:1,class:"provider-logo-fallback"};function ta(l,h,n,g,s,y){return a(),_(Ve,{modelValue:y.showDialog,"onUpdate:modelValue":h[2]||(h[2]=k=>y.showDialog=k),"max-width":"1100px","min-height":"95%"},{default:e(()=>[t(me,{title:g.tm("dialogs.addProvider.title")},{default:e(()=>[t(ce,{style:{"overflow-y":"auto"}},{default:e(()=>[t(Kt,{modelValue:s.activeProviderTab,"onUpdate:modelValue":h[0]||(h[0]=k=>s.activeProviderTab=k),grow:""},{default:e(()=>[t(at,{value:"agent_runner",class:"font-weight-medium px-3"},{default:e(()=>[t(Y,{start:""},{default:e(()=>[o("mdi-cogs")]),_:1}),o(" "+i(g.tm("dialogs.addProvider.tabs.agentRunner")),1)]),_:1}),t(at,{value:"speech_to_text",class:"font-weight-medium px-3"},{default:e(()=>[t(Y,{start:""},{default:e(()=>[o("mdi-microphone-message")]),_:1}),o(" "+i(g.tm("dialogs.addProvider.tabs.speechToText")),1)]),_:1}),t(at,{value:"text_to_speech",class:"font-weight-medium px-3"},{default:e(()=>[t(Y,{start:""},{default:e(()=>[o("mdi-volume-high")]),_:1}),o(" "+i(g.tm("dialogs.addProvider.tabs.textToSpeech")),1)]),_:1}),t(at,{value:"embedding",class:"font-weight-medium px-3"},{default:e(()=>[t(Y,{start:""},{default:e(()=>[o("mdi-code-json")]),_:1}),o(" "+i(g.tm("dialogs.addProvider.tabs.embedding")),1)]),_:1}),t(at,{value:"rerank",class:"font-weight-medium px-3"},{default:e(()=>[t(Y,{start:""},{default:e(()=>[o("mdi-compare-vertical")]),_:1}),o(" "+i(g.tm("dialogs.addProvider.tabs.rerank")),1)]),_:1})]),_:1},8,["modelValue"]),t(Zt,{modelValue:s.activeProviderTab,"onUpdate:modelValue":h[1]||(h[1]=k=>s.activeProviderTab=k),class:"mt-4"},{default:e(()=>[(a(),f(Q,null,ve(["chat_completion","agent_runner","speech_to_text","text_to_speech","embedding","rerank"],k=>t(Qt,{key:k,value:k},{default:e(()=>[t(Ee,{class:"mt-1"},{default:e(()=>[(a(!0),f(Q,null,ve(y.getTemplatesByType(k),(p,m)=>(a(),_(ue,{key:m,cols:"12",sm:"6",md:"4"},{default:e(()=>[t(me,{variant:"outlined",hover:"",class:"provider-card",onClick:q=>y.selectProviderTemplate(m)},{default:e(()=>[$("div",Yl,[$("div",Zl,[t(Pe,{class:"provider-card-title"},{default:e(()=>[o(i(m),1)]),_:2},1024),t(ce,{class:"text-caption text-medium-emphasis provider-card-description"},{default:e(()=>[o(i(y.getProviderDescription(p,m)),1)]),_:2},1024)]),$("div",Ql,[y.getProviderIcon(p.provider)?(a(),f("img",{key:0,src:y.getProviderIcon(p.provider),class:"provider-logo-img"},null,8,Xl)):(a(),f("div",ea,i(m[0].toUpperCase()),1))])])]),_:2},1032,["onClick"])]),_:2},1024))),128)),Object.keys(y.getTemplatesByType(k)).length===0?(a(),_(ue,{key:0,cols:"12"},{default:e(()=>[t(ct,{type:"info",variant:"tonal"},{default:e(()=>[o(i(g.tm("dialogs.addProvider.noTemplates")),1)]),_:1})]),_:1})):O("",!0)]),_:2},1024)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(ke,null,{default:e(()=>[t(pe),t(T,{text:"",onClick:y.closeDialog},{default:e(()=>[o(i(g.tm("dialogs.config.cancel")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}const la=Ue(Gl,[["render",ta],["__scopeId","data-v-e5c13529"]]);const aa={class:"mt-4"},oa={class:"d-flex align-center ga-2 mb-2"},ia={class:"text-h5 font-weight-bold mb-0"},na={key:0,style:{color:"grey"}},sa={key:3},da={key:3},ra={key:1,class:"text-center pa-4 text-medium-emphasis"},ua={class:"text-grey mt-2"},ca={__name:"ProviderModelsPanel",props:{entries:{type:Array,default:()=>[]},availableCount:{type:Number,default:0},modelSearch:{type:String,default:""},loadingModels:{type:Boolean,default:!1},isSourceModified:{type:Boolean,default:!1},supportsImageInput:{type:Function,required:!0},supportsToolCall:{type:Function,required:!0},supportsReasoning:{type:Function,required:!0},formatContextLimit:{type:Function,required:!0},testingProviders:{type:Array,default:()=>[]},tm:{type:Function,required:!0}},emits:["update:modelSearch","fetch-models","open-manual-model","open-provider-edit","toggle-provider-enable","test-provider","delete-provider","add-model-provider"],setup(l,{emit:h}){const n=l,g=ie({get:()=>n.modelSearch,set:y=>h("update:modelSearch",y)}),s=y=>n.testingProviders.includes(y);return(y,k)=>(a(),f("div",aa,[$("div",oa,[$("h3",ia,i(l.tm("models.configured")),1),l.availableCount?(a(),f("small",na,i(l.tm("models.available"))+" "+i(l.availableCount),1)):O("",!0),t(_e,{modelValue:g.value,"onUpdate:modelValue":k[0]||(k[0]=p=>g.value=p),density:"compact","prepend-inner-icon":"mdi-magnify","hide-details":"",variant:"solo-filled",flat:"",class:"ml-1",style:{"max-width":"240px"},placeholder:l.tm("models.searchPlaceholder")},null,8,["modelValue","placeholder"]),t(pe),t(T,{color:"primary","prepend-icon":"mdi-download",loading:l.loadingModels,onClick:k[1]||(k[1]=p=>h("fetch-models")),variant:"tonal",size:"small"},{default:e(()=>[o(i(l.isSourceModified?l.tm("providerSources.saveAndFetchModels"):l.tm("providerSources.fetchModels")),1)]),_:1},8,["loading"]),t(T,{color:"primary","prepend-icon":"mdi-pencil-plus",variant:"text",size:"small",class:"ml-1",onClick:k[2]||(k[2]=p=>h("open-manual-model"))},{default:e(()=>[o(i(l.tm("models.manualAddButton")),1)]),_:1})]),t(qe,{density:"compact",class:"rounded-lg border",style:{"max-height":"520px","overflow-y":"auto","font-family":"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif"}},{default:e(()=>[l.entries.length>0?(a(!0),f(Q,{key:0},ve(l.entries,p=>(a(),f(Q,{key:p.type==="configured"?`provider-${p.provider.id}`:`model-${p.model}`},[p.type==="configured"?(a(),_($e,{key:0,class:"provider-compact-item",onClick:m=>h("open-provider-edit",p.provider)},{append:e(()=>[$("div",{class:"d-flex align-center ga-1",onClick:k[3]||(k[3]=Fe(()=>{},["stop"]))},[t(st,{modelValue:p.provider.enable,"onUpdate:modelValue":[m=>p.provider.enable=m,m=>h("toggle-provider-enable",p.provider,m)],density:"compact",inset:"","hide-details":"",color:"primary",class:"mr-1"},null,8,["modelValue","onUpdate:modelValue"]),t(ut,{location:"top","max-width":"300"},{activator:e(({props:m})=>[t(T,Ze({icon:"mdi-connection",size:"small",variant:"text",disabled:!p.provider.enable,loading:s(p.provider.id)},m,{onClick:Fe(q=>h("test-provider",p.provider),["stop"])}),null,16,["disabled","loading","onClick"])]),default:e(()=>[o(i(l.tm("availability.test"))+" ",1)]),_:2},1024),t(ut,{location:"top","max-width":"300"},{activator:e(({props:m})=>[t(T,Ze({icon:"mdi-cog",size:"small",variant:"text"},m,{onClick:Fe(q=>h("open-provider-edit",p.provider),["stop"])}),null,16,["onClick"])]),default:e(()=>[o(i(l.tm("models.configure"))+" ",1)]),_:2},1024),t(T,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:Fe(m=>h("delete-provider",p.provider),["stop"])},null,8,["onClick"])])]),default:e(()=>[t(he,{class:"font-weight-medium text-truncate"},{default:e(()=>[o(i(p.provider.id),1)]),_:2},1024),t(xe,{class:"text-caption text-grey d-flex align-center ga-1",style:{"font-family":"monospace"}},{default:e(()=>[$("span",null,i(p.provider.model),1),l.supportsImageInput(p.metadata)?(a(),_(Y,{key:0,size:"14",color:"grey"},{default:e(()=>[o(" mdi-eye-outline ")]),_:1})):O("",!0),l.supportsToolCall(p.metadata)?(a(),_(Y,{key:1,size:"14",color:"grey"},{default:e(()=>[o(" mdi-wrench ")]),_:1})):O("",!0),l.supportsReasoning(p.metadata)?(a(),_(Y,{key:2,size:"14",color:"grey"},{default:e(()=>[o(" mdi-brain ")]),_:1})):O("",!0),l.formatContextLimit(p.metadata)?(a(),f("span",sa,i(l.formatContextLimit(p.metadata)),1)):O("",!0)]),_:2},1024)]),_:2},1032,["onClick"])):(a(),_($e,{key:1,class:"cursor-pointer",onClick:m=>h("add-model-provider",p.model)},{append:e(()=>[t(T,{icon:"mdi-plus",size:"small",variant:"text",color:"primary"})]),default:e(()=>[t(he,null,{default:e(()=>[o(i(p.model),1)]),_:2},1024),t(xe,{class:"text-caption text-grey d-flex align-center ga-1"},{default:e(()=>[$("span",null,i(p.model),1),l.supportsImageInput(p.metadata)?(a(),_(Y,{key:0,size:"14",color:"grey"},{default:e(()=>[o(" mdi-eye-outline ")]),_:1})):O("",!0),l.supportsToolCall(p.metadata)?(a(),_(Y,{key:1,size:"14",color:"grey"},{default:e(()=>[o(" mdi-wrench ")]),_:1})):O("",!0),l.supportsReasoning(p.metadata)?(a(),_(Y,{key:2,size:"14",color:"grey"},{default:e(()=>[o(" mdi-brain ")]),_:1})):O("",!0),l.formatContextLimit(p.metadata)?(a(),f("span",da,i(l.formatContextLimit(p.metadata)),1)):O("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))],64))),128)):(a(),f("div",ra,[t(Y,{size:"48",color:"grey-lighten-1"},{default:e(()=>[o("mdi-package-variant")]),_:1}),$("p",ua,i(l.tm("models.empty")),1)]))]),_:1})]))}},ma=Ue(ca,[["__scopeId","data-v-7a25f224"]]);const va={class:"d-flex align-center justify-space-between px-4 pt-4 pb-2"},fa={class:"d-flex align-center ga-2"},pa={class:"mb-0"},ga={key:0},ya={class:"d-flex align-center ga-1"},ha={key:1,class:"text-center py-8 px-4"},ba={class:"text-grey mt-2"},_a={__name:"ProviderSourcesPanel",props:{displayedProviderSources:{type:Array,default:()=>[]},selectedProviderSource:{type:Object,default:null},availableSourceTypes:{type:Array,default:()=>[]},tm:{type:Function,required:!0},resolveSourceIcon:{type:Function,required:!0},getSourceDisplayName:{type:Function,required:!0}},emits:["add-provider-source","select-provider-source","delete-provider-source"],setup(l,{emit:h}){const n=l,g=ie(()=>{var m;return((m=n.selectedProviderSource)==null?void 0:m.id)||null}),s=m=>m.isPlaceholder?!1:g.value!==null&&g.value===m.id,y=m=>h("add-provider-source",m),k=m=>h("select-provider-source",m),p=m=>h("delete-provider-source",m);return(m,q)=>(a(),_(me,{class:"provider-sources-panel h-100",elevation:"0"},{default:e(()=>[$("div",va,[$("div",fa,[$("h3",pa,i(l.tm("providerSources.title")),1)]),t(Lt,null,{activator:e(({props:x})=>[t(T,Ze(x,{"prepend-icon":"mdi-plus",color:"primary",variant:"tonal",rounded:"xl",size:"small"}),{default:e(()=>[o(" æ–°å¢ ")]),_:2},1040)]),default:e(()=>[t(qe,{density:"compact"},{default:e(()=>[(a(!0),f(Q,null,ve(l.availableSourceTypes,x=>(a(),_($e,{key:x.value,onClick:G=>y(x.value)},{default:e(()=>[t(he,null,{default:e(()=>[o(i(x.label),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),l.displayedProviderSources.length>0?(a(),f("div",ga,[t(qe,{class:"provider-source-list",nav:"",density:"compact",lines:"two"},{default:e(()=>[(a(!0),f(Q,null,ve(l.displayedProviderSources,x=>(a(),_($e,{key:x.isPlaceholder?`template-${x.templateKey}`:x.id,value:x.id,active:s(x),class:At(["provider-source-list-item",{"provider-source-list-item--active":s(x)}]),rounded:"lg",onClick:G=>k(x)},{prepend:e(()=>[t(Xt,{size:"32",class:"bg-grey-lighten-4",rounded:"0"},{default:e(()=>[x!=null&&x.provider?(a(),_(Bt,{key:0,src:l.resolveSourceIcon(x),alt:"logo",cover:""},null,8,["src"])):(a(),_(Y,{key:1,size:"32"},{default:e(()=>[o("mdi-creation")]),_:1}))]),_:2},1024)]),append:e(()=>[$("div",ya,[x.isPlaceholder?O("",!0):(a(),_(T,{key:0,icon:"mdi-delete",variant:"text",size:"x-small",color:"error",onClick:Fe(G=>p(x),["stop"])},null,8,["onClick"]))])]),default:e(()=>[t(he,{class:"font-weight-bold"},{default:e(()=>[o(i(l.getSourceDisplayName(x)),1)]),_:2},1024),t(xe,{class:"text-truncate"},{default:e(()=>[o(i(x.api_base||"N/A"),1)]),_:2},1024)]),_:2},1032,["value","active","class","onClick"]))),128))]),_:1})])):(a(),f("div",ha,[t(Y,{size:"48",color:"grey-lighten-1"},{default:e(()=>[o("mdi-api-off")]),_:1}),$("p",ba,i(l.tm("providerSources.empty")),1)]))]),_:1}))}},xa=Ue(_a,[["__scopeId","data-v-c3620f86"]]);function jt(l){const h=(l||"").toLowerCase();return h.startsWith("select_agent_runner_provider")||h==="agent_runner"?"agent_runner":h==="select_provider_stt"||h==="speech_to_text"||h.includes("stt")?"speech_to_text":h==="select_provider_tts"||h==="text_to_speech"||h.includes("tts")?"text_to_speech":h.includes("embedding")?"embedding":h.includes("rerank")?"rerank":"chat_completion"}function ka(l){const{tm:h,showMessage:n}=l,g=V({}),s=V({}),y=V([]),k=V([]),p=V(jt(l.defaultTab)),m=V(null),q=V(null),x=V(null),G=V([]),A=V({}),N=V(!1),B=V(!1),H=V([]),j=V(!1),C=V({}),S=V({}),E=V(""),L=V("");let I=!1;const U=[{value:"chat_completion",label:h("providers.tabs.chatCompletion"),icon:"mdi-message-text"},{value:"agent_runner",label:h("providers.tabs.agentRunner"),icon:"mdi-robot"},{value:"speech_to_text",label:h("providers.tabs.speechToText"),icon:"mdi-microphone-message"},{value:"text_to_speech",label:h("providers.tabs.textToSpeech"),icon:"mdi-volume-high"},{value:"embedding",label:h("providers.tabs.embedding"),icon:"mdi-code-json"},{value:"rerank",label:h("providers.tabs.rerank"),icon:"mdi-compare-vertical"}],v=ie(()=>{if(!S.value||Object.keys(S.value).length===0)return[];const c=[];for(const[P,z]of Object.entries(S.value))z.provider_type===p.value&&c.push({value:P,label:P});return c}),K=ie(()=>y.value?y.value.filter(c=>c.provider_type===p.value||c.type&&W(c.type,p.value)):[]),r=ie(()=>{const c=K.value||[],P=new Set(c.map(M=>M.provider).filter(Boolean)),z=[];if(S.value&&Object.keys(S.value).length>0)for(const[M,X]of Object.entries(S.value))X.provider_type===p.value&&X.provider&&(P.has(X.provider)||z.push({id:X.id||M,provider:X.provider,provider_type:X.provider_type,type:X.type,api_base:X.api_base||"",templateKey:M,isPlaceholder:!0}));return[...c,...z]}),b=ie(()=>!m.value||!k.value?[]:k.value.filter(c=>c.provider_source_id===m.value.id)),d=ie(()=>m.value?new Set(b.value.map(c=>c.model)):new Set),w=ie(()=>{const c=d.value;return[...G.value||[]].sort((P,z)=>{const M=typeof P=="string"?P:P==null?void 0:P.name,X=typeof z=="string"?z:z==null?void 0:z.name,fe=c.has(M),De=c.has(X);return fe&&!De?-1:!fe&&De?1:0})}),D=ie(()=>{const c=(b.value||[]).map(z=>({type:"configured",provider:z,metadata:je(z.model)})),P=(w.value||[]).filter(z=>{const M=typeof z=="string"?z:z==null?void 0:z.name;return!d.value.has(M)}).map(z=>{const M=typeof z=="string"?z:z==null?void 0:z.name;return{type:"available",model:M,metadata:typeof z=="object"?z==null?void 0:z.metadata:je(M)}});return[...c,...P]}),ge=ie(()=>{const c=L.value.trim().toLowerCase();return c?D.value.filter(P=>{var M,X,fe;if(P.type==="configured"){const De=((M=P.provider.id)==null?void 0:M.toLowerCase())||"",et=((X=P.provider.model)==null?void 0:X.toLowerCase())||"";return De.includes(c)||et.includes(c)}return(((fe=P.model)==null?void 0:fe.toLowerCase())||"").includes(c)}):D.value}),Te=ie(()=>{if(!m.value)return"";const c=E.value.trim();return c?`${m.value.id}/${c}`:""}),de=ie(()=>{if(!x.value)return null;const c=["id","key","api_base"],P={};return c.forEach(z=>{Object.defineProperty(P,z,{get(){return x.value[z]},set(M){x.value[z]=M},enumerable:!0})}),P}),re=ie(()=>{if(!x.value)return null;const c=["id","key","api_base","enable","type","provider_type","provider"],P={};for(const z of Object.keys(x.value))c.includes(z)||Object.defineProperty(P,z,{get(){return x.value[z]},set(M){x.value[z]=M},enumerable:!0});return P}),ye=ie(()=>!k.value||p.value==="chat_completion"?[]:k.value.filter(c=>ze(c)===p.value));Ae(x,()=>{I||x.value&&(j.value=!0)},{deep:!0});function W(c,P){return!c||!P?!1:P==="chat_completion"?c.includes("chat_completion"):c.includes(P)}function Z(c){return c&&Pt(c.provider)||""}function ae(c){return c?c.isPlaceholder?c.templateKey||c.id||"":c.id:""}function je(c){var P;return c&&((P=A.value)==null?void 0:P[c])||null}function He(c){var z;return(((z=c==null?void 0:c.modalities)==null?void 0:z.input)||[]).includes("image")}function Qe(c){return!!(c!=null&&c.tool_call)}function Je(c){return!!(c!=null&&c.reasoning)}function We(c){var z;const P=(z=c==null?void 0:c.limit)==null?void 0:z.context;return!P||typeof P!="number"?"":P>=1e6?`${Math.round(P/1e6)}M`:P>=1e3?`${Math.round(P/1e3)}K`:`${P}`}function ze(c){return c?c.provider_type?c.provider_type:{openai_chat_completion:"chat_completion",anthropic_chat_completion:"chat_completion",googlegenai_chat_completion:"chat_completion",zhipu_chat_completion:"chat_completion",dify:"agent_runner",coze:"agent_runner",dashscope:"chat_completion",openai_whisper_api:"speech_to_text",openai_whisper_selfhost:"speech_to_text",sensevoice_stt_selfhost:"speech_to_text",openai_tts_api:"text_to_speech",edge_tts:"text_to_speech",gsvi_tts_api:"text_to_speech",fishaudio_tts_api:"text_to_speech",dashscope_tts:"text_to_speech",azure_tts:"text_to_speech",minimax_tts_api:"text_to_speech",volcengine_tts:"text_to_speech"}[c.type]:void 0}function Re(c){if(c!=null&&c.isPlaceholder&&c.templateKey){Oe(c.templateKey);return}m.value=c,q.value=(c==null?void 0:c.id)||null,I=!0,x.value=c?JSON.parse(JSON.stringify(c)):null,kt(()=>{I=!1}),G.value=[],A.value={},j.value=!1}function Be(c){const P={},z=["id","enable","model","provider_source_id","modalities","custom_extra_body"];for(const[M,X]of Object.entries(c))z.includes(M)||(P[M]=X);return P}function Ge(c){const P=new Set(y.value.map(X=>X.id));if(!P.has(c))return c;let z=1,M=`${c}_${z}`;for(;P.has(M);)z+=1,M=`${c}_${z}`;return M}function Oe(c){const P=S.value[c];if(!P){n("æœªæ‰¾åˆ°å¯¹åº”çš„æ¨¡æ¿é…ç½®","error");return}const z=Ge(P.id),M={...Be(P),id:z,type:P.type,provider_type:P.provider_type,provider:P.provider,enable:!0};y.value.push(M),m.value=M,q.value=z,x.value=JSON.parse(JSON.stringify(M)),G.value=[],A.value={},j.value=!0}async function Ke(c){var P;if(confirm(h("providerSources.deleteConfirm",{id:c.id})))try{await se.post("/api/config/provider_sources/delete",{id:c.id}),k.value=k.value.filter(z=>z.provider_source_id!==c.id),y.value=y.value.filter(z=>z.id!==c.id),((P=m.value)==null?void 0:P.id)===c.id&&(m.value=null,q.value=null,x.value=null),n(h("providerSources.deleteSuccess"))}catch(z){n(z.message||h("providerSources.deleteError"),"error")}finally{await Le()}}async function we(){var P,z;if(!m.value)return;B.value=!0;const c=q.value||m.value.id;try{const M=await se.post("/api/config/provider_sources/update",{config:x.value,original_id:c});if(M.data.status!=="ok")throw new Error(M.data.message);x.value.id!==c&&(k.value=k.value.map(fe=>fe.provider_source_id===c?{...fe,provider_source_id:x.value.id}:fe),q.value=x.value.id);const X=y.value.findIndex(fe=>fe.id===c);return X!==-1&&(y.value[X]=JSON.parse(JSON.stringify(x.value)),m.value=y.value[X]),I=!0,x.value=m.value,kt(()=>{I=!1}),j.value=!1,n(M.data.message||h("providerSources.saveSuccess")),!0}catch(M){return n(((z=(P=M.response)==null?void 0:P.data)==null?void 0:z.message)||M.message||h("providerSources.saveError"),"error"),!1}finally{B.value=!1,Le()}}async function Ne(){var c,P,z;if(m.value&&!(j.value&&!await we())){N.value=!0;try{const M=((c=x.value)==null?void 0:c.id)||m.value.id,X=await se.get("/api/config/provider_sources/models",{params:{source_id:M}});if(X.data.status==="ok"){const fe=X.data.data.model_metadata||{};A.value=fe,G.value=(X.data.data.models||[]).map(De=>({name:De,metadata:(fe==null?void 0:fe[De])||null})),G.value.length===0&&n(h("models.noModelsFound"),"info")}else throw new Error(X.data.message)}catch(M){A.value={},n(((z=(P=M.response)==null?void 0:P.data)==null?void 0:z.message)||M.message||h("models.fetchError"),"error")}finally{N.value=!1}}}async function Se(c){var De,et,lt;if(!m.value)return;const P=((De=x.value)==null?void 0:De.id)||m.value.id,z=`${P}/${c}`,M=je(c);let X;M?(X=["text"],He(M)&&X.push("image"),Qe(M)&&X.push("tool_use")):X=["text","image","tool_use"];const fe={id:z,enable:!1,provider_source_id:P,model:c,modalities:X,custom_extra_body:{}};try{const Ie=await se.post("/api/config/provider/new",fe);if(Ie.data.status==="error")throw new Error(Ie.data.message);k.value.push(fe),n(Ie.data.message||h("models.addSuccess",{model:c}))}catch(Ie){n(((lt=(et=Ie.response)==null?void 0:et.data)==null?void 0:lt.message)||Ie.message||h("providerSources.saveError"),"error")}finally{await Le()}}function Ce(c){return d.value.has(c)}async function dt(c){if(confirm(h("models.deleteConfirm",{id:c.id})))try{await se.post("/api/config/provider/delete",{id:c.id}),k.value=k.value.filter(P=>P.id!==c.id),n(h("models.deleteSuccess"))}catch(P){n(P.message||h("models.deleteError"),"error")}finally{await Le()}}async function Xe(c){var P,z;H.value.push(c.id);try{const M=await se.get("/api/config/provider/check_one",{params:{id:c.id}});if(M.data.status==="ok"&&M.data.data.error===null)n(h("models.testSuccess",{id:c.id}));else throw new Error(M.data.data.error||h("models.testError"))}catch(M){n(((z=(P=M.response)==null?void 0:P.data)==null?void 0:z.message)||M.message||h("models.testError"),"error")}finally{H.value=H.value.filter(M=>M!==c.id)}}async function Le(){it()}async function it(){var c;try{const P=await se.get("/api/config/provider/template");P.data.status==="ok"&&(C.value=P.data.data.config_schema||{},(c=C.value.provider)!=null&&c.config_template&&(S.value=C.value.provider.config_template),y.value=P.data.data.provider_sources||[],k.value=P.data.data.providers||[])}catch(P){console.error("Failed to load provider template:",P)}}function gt(c){p.value=jt(c)}return el(async()=>{await it()}),{config:g,metadata:s,providerSources:y,providers:k,selectedProviderType:p,selectedProviderSource:m,selectedProviderSourceOriginalId:q,editableProviderSource:x,availableModels:G,modelMetadata:A,loadingModels:N,savingSource:B,testingProviders:H,isSourceModified:j,configSchema:C,providerTemplates:S,manualModelId:E,modelSearch:L,providerTypes:U,availableSourceTypes:v,displayedProviderSources:r,sourceProviders:b,mergedModelEntries:D,filteredMergedModelEntries:ge,filteredProviders:ye,basicSourceConfig:de,advancedSourceConfig:re,manualProviderId:Te,resolveSourceIcon:Z,getSourceDisplayName:ae,getModelMetadata:je,supportsImageInput:He,supportsToolCall:Qe,supportsReasoning:Je,formatContextLimit:We,getProviderType:ze,updateDefaultTab:gt,selectProviderSource:Re,addProviderSource:Oe,deleteProviderSource:Ke,saveProviderSource:we,fetchAvailableModels:Ne,addModelProvider:Se,deleteProvider:dt,modelAlreadyConfigured:Ce,testProvider:Xe,loadConfig:Le,loadProviderTemplate:it}}const Rt=l=>(vt("data-v-dc517db4"),l=l(),ft(),l),Va={class:"provider-page"},wa={class:"text-h1 font-weight-bold mb-2"},Sa={class:"text-subtitle-1 text-medium-emphasis mb-4"},Ca={key:0},Pa={key:0,class:"d-flex align-center justify-center"},$a={key:0,class:"d-flex align-center ga-3"},Ta={class:"text-h4 font-weight-bold"},Ia={class:"text-caption text-medium-emphasis"},Ua={key:1,class:"d-flex align-center ga-2"},ja={class:"font-weight-medium"},Ea={key:1,class:"text-center py-8 text-medium-emphasis"},za={class:"mt-2"},Oa={class:"text-grey mt-4"},Da={key:0},Aa={key:1},Ba=Rt(()=>$("small",{style:{color:"gray"}},"ä¸å»ºè®®ä¿®æ”¹ IDï¼Œå¯èƒ½ä¼šå¯¼è‡´æŒ‡å‘è¯¥æ¨¡å‹çš„ç›¸å…³é…ç½®ï¼ˆå¦‚é»˜è®¤æ¨¡å‹ã€æ’ä»¶ç›¸å…³é…ç½®ç­‰ï¼‰å¤±æ•ˆã€‚",-1)),Ka=Rt(()=>$("ol",{class:"ml-4 mt-4 mb-4"},[$("li",null,"æ‰¾åˆ°å¯¹åº”çš„é…ç½®æ–‡ä»¶å¹¶æ‰“å¼€ã€‚"),$("li",null,"æ‰¾åˆ° Agent æ‰§è¡Œæ–¹å¼éƒ¨åˆ†ï¼Œä¿®æ”¹æ‰§è¡Œå™¨åç‚¹å‡»ä¿å­˜ã€‚"),$("li",null,"ç‚¹å‡»å³ä¸‹è§’çš„ ğŸ’¬ èŠå¤©æŒ‰é’®è¿›è¡Œæµ‹è¯•ã€‚")],-1)),La={__name:"ProviderPage",props:{defaultTab:{type:String,default:"chat_completion"}},setup(l){const h=l,{tm:n}=ot("features/provider"),g=Nt(),s=V({show:!1,message:"",color:"success"});function y(J,R="success"){s.value={show:!0,message:J,color:R}}const{providers:k,selectedProviderType:p,selectedProviderSource:m,availableModels:q,loadingModels:x,savingSource:G,testingProviders:A,isSourceModified:N,configSchema:B,manualModelId:H,modelSearch:j,providerTypes:C,availableSourceTypes:S,displayedProviderSources:E,filteredMergedModelEntries:L,filteredProviders:I,basicSourceConfig:U,advancedSourceConfig:v,manualProviderId:K,resolveSourceIcon:r,getSourceDisplayName:b,supportsImageInput:d,supportsToolCall:w,supportsReasoning:D,formatContextLimit:ge,updateDefaultTab:Te,selectProviderSource:de,addProviderSource:re,deleteProviderSource:ye,saveProviderSource:W,fetchAvailableModels:Z,addModelProvider:ae,deleteProvider:je,modelAlreadyConfigured:He,testProvider:Qe,loadConfig:Je}=ka({defaultTab:h.defaultTab,tm:n,showMessage:y}),We=V(!1),ze=V(!1),Re=V(""),Be=V({}),Ge=V(""),Oe=V(!1),Ke=V(!1),we=V([]),Ne=V(!1),Se=V(!1),Ce=V(null),dt=V(""),Xe=V(!1),Le=V([]);function it(J){Ce.value=JSON.parse(JSON.stringify(J)),dt.value=J.id,Se.value=!0}function gt(){if(!m.value){y(n("providerSources.selectHint"),"error");return}H.value="",Xe.value=!0}async function c(){const J=H.value.trim();if(!m.value){y(n("providerSources.selectHint"),"error");return}if(!J){y(n("models.manualModelRequired"),"error");return}if(He(J)){y(n("models.manualModelExists"),"error");return}await ae(J),Xe.value=!1}Ae(()=>h.defaultTab,J=>{Te(J)});function P(){return n("providers.empty.typed",{type:p.value})}function z(J){Re.value=J,Ge.value="",ze.value=!0,Oe.value=!1,Be.value=JSON.parse(JSON.stringify(B.value.provider.config_template[J]||{}))}function M(J){var te;Re.value=J.id,Ge.value=J.id,Be.value={};let R=B.value.provider.config_template||{},F={};for(let ne in R)if(((te=R[ne])==null?void 0:te.type)===J.type){F=R[ne];break}const oe=(ne,le,be)=>{if(le&&typeof le=="object"&&!Array.isArray(le))for(let ee in le)le.hasOwnProperty(ee)&&(typeof le[ee]=="object"&&le[ee]!==null?ne[ee]=Array.isArray(le[ee])?[...le[ee]]:{...le[ee]}:ne[ee]=le[ee]);for(let ee in be)typeof be[ee]=="object"&&be[ee]!==null?(ee in ne||(Array.isArray(be[ee])?ne[ee]=[...be[ee]]:ne[ee]={}),Array.isArray(be[ee])||oe(ne[ee],le&&le[ee]?le[ee]:{},be[ee])):ee in ne||(ne[ee]=be[ee])};F&&oe(Be.value,J,F),ze.value=!0,Oe.value=!0}async function X(){var R,F;Ke.value=!0;const J=Oe.value;try{if(J){const oe=await se.post("/api/config/provider/update",{id:Ge.value||Re.value,config:Be.value});if(oe.data.status==="error"){y(oe.data.message||"æ›´æ–°å¤±è´¥!","error");return}y(oe.data.message||"æ›´æ–°æˆåŠŸ!"),J&&(Oe.value=!1)}else{const oe=await se.post("/api/config/provider/new",Be.value);if(oe.data.status==="error"){y(oe.data.message||"æ·»åŠ å¤±è´¥!","error");return}y(oe.data.message||"æ·»åŠ æˆåŠŸ!")}ze.value=!1}catch(oe){y(((F=(R=oe.response)==null?void 0:R.data)==null?void 0:F.message)||oe.message,"error")}finally{Ke.value=!1,await Je()}}async function fe(){var J,R;if(Ce.value){Le.value.push(Ce.value.id);try{const F=await se.post("/api/config/provider/update",{id:dt.value||Ce.value.id,config:Ce.value});if(F.data.status==="error")throw new Error(F.data.message);y(F.data.message||n("providerSources.saveSuccess")),Se.value=!1,await Je()}catch(F){y(((R=(J=F.response)==null?void 0:J.data)==null?void 0:R.message)||F.message||n("providerSources.saveError"),"error")}finally{Le.value=Le.value.filter(F=>{var oe;return F!==((oe=Ce.value)==null?void 0:oe.id)})}}}async function De(J){var oe,te;const R=JSON.parse(JSON.stringify(J)),F=ne=>{let le=`${ne}_copy`,be=1;const ee=k.value.map(yt=>yt.id);for(;ee.includes(le);)le=`${ne}_copy_${be}`,be++;return le};R.id=F(J.id),R.enable=!1,Ke.value=!0;try{const ne=await se.post("/api/config/provider/new",R);y(ne.data.message||`æˆåŠŸå¤åˆ¶å¹¶åˆ›å»ºäº† ${R.id}`),await Je()}catch(ne){y(((te=(oe=ne.response)==null?void 0:oe.data)==null?void 0:te.message)||ne.message,"error")}finally{Ke.value=!1}}async function et(J,R){var F,oe;J.enable=R;try{const te=await se.post("/api/config/provider/update",{id:J.id,config:J});if(te.data.status==="error")throw new Error(te.data.message);y(te.data.message||n("messages.success.statusUpdate"))}catch(te){y(((oe=(F=te.response)==null?void 0:F.data)==null?void 0:oe.message)||te.message||n("providerSources.saveError"),"error")}finally{await Je()}}function lt(J){return A.value.includes(J)}function Ie(J){return we.value.find(R=>R.id===J)}async function Ht(J){var oe,te,ne;if(lt(J.id))return;A.value.push(J.id);const R=we.value.findIndex(le=>le.id===J.id),F={id:J.id,name:J.id,status:"pending",error:null};R!==-1?we.value.splice(R,1,F):we.value.unshift(F);try{if(!J.enable)throw new Error("è¯¥æä¾›å•†æœªè¢«ç”¨æˆ·å¯ç”¨");if(J.provider_type==="agent_runner"){Ne.value=!0,we.value=we.value.filter(be=>be.id!==J.id);return}const le=await se.get(`/api/config/provider/check_one?id=${J.id}`);if(le.data&&le.data.status==="ok"){const be=we.value.findIndex(ee=>ee.id===J.id);be!==-1&&we.value.splice(be,1,le.data.data)}else throw new Error(((oe=le.data)==null?void 0:oe.message)||`Failed to check status for ${J.id}`)}catch(le){const be=((ne=(te=le.response)==null?void 0:te.data)==null?void 0:ne.message)||le.message||"Unknown error",ee=we.value.findIndex(Yt=>Yt.id===J.id),yt={id:J.id,name:J.id,status:"unavailable",error:be};ee!==-1&&we.value.splice(ee,1,yt)}finally{const le=A.value.indexOf(J.id);le>-1&&A.value.splice(le,1)}}function Wt(J){switch(J){case"available":return"success";case"unavailable":return"error";case"pending":return"grey";default:return"default"}}function Tt(J){return{available:n("availability.available"),unavailable:n("availability.unavailable"),pending:n("availability.pending")}[J]||J}function Gt(){g.push("/config"),Ne.value=!1}return(J,R)=>(a(),f("div",Va,[t(tl,{fluid:"",class:"pa-0"},{default:e(()=>[t(Ee,{class:"d-flex justify-space-between align-center px-4 py-3 pb-4"},{default:e(()=>[$("div",null,[$("h1",wa,[t(Y,{color:"black",class:"me-2"},{default:e(()=>[o("mdi-creation")]),_:1}),o(i(u(n)("title")),1)]),$("p",Sa,i(u(n)("subtitle")),1)]),u(p)!=="chat_completion"?(a(),f("div",Ca,[t(T,{color:"primary","prepend-icon":"mdi-plus",variant:"tonal",onClick:R[0]||(R[0]=F=>We.value=!0),rounded:"xl",size:"x-large"},{default:e(()=>[o(i(u(n)("providers.addProvider")),1)]),_:1})])):O("",!0)]),_:1}),$("div",null,[t(Kt,{modelValue:u(p),"onUpdate:modelValue":R[1]||(R[1]=F=>bt(p)?p.value=F:null),"bg-color":"transparent",class:"mb-4"},{default:e(()=>[(a(!0),f(Q,null,ve(u(C),F=>(a(),_(at,{key:F.value,value:F.value,class:"font-weight-medium px-3"},{default:e(()=>[t(Y,{start:""},{default:e(()=>[o(i(F.icon),1)]),_:2},1024),o(" "+i(F.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),u(p)==="chat_completion"?(a(),f("div",Pa,[t(Ee,{style:{"max-width":"1500px"}},{default:e(()=>[t(ue,{cols:"12",md:"4",lg:"3",class:"pr-md-4"},{default:e(()=>[t(xa,{"displayed-provider-sources":u(E),"selected-provider-source":u(m),"available-source-types":u(S),tm:u(n),"resolve-source-icon":u(r),"get-source-display-name":u(b),onAddProviderSource:u(re),onSelectProviderSource:u(de),onDeleteProviderSource:u(ye)},null,8,["displayed-provider-sources","selected-provider-source","available-source-types","tm","resolve-source-icon","get-source-display-name","onAddProviderSource","onSelectProviderSource","onDeleteProviderSource"])]),_:1}),t(ue,{cols:"12",md:"8",lg:"9"},{default:e(()=>[t(me,{class:"provider-config-card h-100",elevation:"0",style:{"overflow-y":"auto"}},{default:e(()=>[t(Pe,{class:"d-flex align-center justify-space-between flex-wrap ga-3 pt-4 pl-5"},{default:e(()=>[u(m)?(a(),f("div",$a,[$("div",null,[$("div",Ta,i(u(m).id),1),$("div",Ia,i(u(m).api_base||"N/A"),1)])])):O("",!0),u(m)?(a(),f("div",Ua,[t(T,{color:"success","prepend-icon":"mdi-check",loading:u(G),disabled:!u(N),onClick:u(W),variant:"flat"},{default:e(()=>[o(i(u(n)("providerSources.save")),1)]),_:1},8,["loading","disabled","onClick"])])):O("",!0)]),_:1}),t(ce,null,{default:e(()=>[u(m)?(a(),f(Q,{key:0},[$("div",null,[u(U)?(a(),_(rt,{key:0,iterable:u(U),metadata:u(B),metadataKey:"provider","is-editing":!0},null,8,["iterable","metadata"])):O("",!0)]),t(al,{variant:"accordion",class:"mb-2"},{default:e(()=>[t(ol,{elevation:"0",class:"border rounded-lg"},{default:e(()=>[t(il,null,{default:e(()=>[$("span",ja,i(u(n)("providerSources.advancedConfig")),1)]),_:1}),t(nl,null,{default:e(()=>[u(v)?(a(),_(rt,{key:0,iterable:u(v),metadata:u(B),metadataKey:"provider","is-editing":!0},null,8,["iterable","metadata"])):O("",!0)]),_:1})]),_:1})]),_:1}),t(ma,{entries:u(L),"available-count":u(q).length,"model-search":u(j),"onUpdate:modelSearch":R[2]||(R[2]=F=>bt(j)?j.value=F:null),"loading-models":u(x),"is-source-modified":u(N),"supports-image-input":u(d),"supports-tool-call":u(w),"supports-reasoning":u(D),"format-context-limit":u(ge),"testing-providers":u(A),tm:u(n),onFetchModels:u(Z),onOpenManualModel:gt,onOpenProviderEdit:it,onToggleProviderEnable:et,onTestProvider:u(Qe),onDeleteProvider:u(je),onAddModelProvider:u(ae)},null,8,["entries","available-count","model-search","loading-models","is-source-modified","supports-image-input","supports-tool-call","supports-reasoning","format-context-limit","testing-providers","tm","onFetchModels","onTestProvider","onDeleteProvider","onAddModelProvider"])],64)):(a(),f("div",Ea,[t(Y,{size:"48",color:"grey-lighten-1"},{default:e(()=>[o("mdi-cursor-default-click")]),_:1}),$("p",za,i(u(n)("providerSources.selectHint")),1)]))]),_:1})]),_:1})]),_:1})]),_:1})])):(a(),f(Q,{key:1},[u(I).length===0?(a(),_(Ee,{key:0},{default:e(()=>[t(ue,{cols:"12",class:"text-center pa-8"},{default:e(()=>[t(Y,{size:"64",color:"grey-lighten-1"},{default:e(()=>[o("mdi-api-off")]),_:1}),$("p",Oa,i(P()),1)]),_:1})]),_:1})):(a(),_(Ee,{key:1},{default:e(()=>[(a(!0),f(Q,null,ve(u(I),(F,oe)=>(a(),_(ue,{key:oe,cols:"12",md:"6",lg:"4",xl:"3"},{default:e(()=>[t(Hl,{item:F,"title-field":"id","enabled-field":"enable",loading:lt(F.id),onToggleEnabled:te=>et(F,!F.enable),bglogo:u(Pt)(F.provider),onDelete:u(je),onEdit:M,onCopy:De,"show-copy-button":!0},{"item-details":e(({item:te})=>[Ie(te.id)?(a(),_(ut,{key:0,location:"top","max-width":"300"},{activator:e(({props:ne})=>[t(Ye,Ze(ne,{color:Wt(Ie(te.id).status),size:"small"}),{default:e(()=>[t(Y,{start:"",size:"small"},{default:e(()=>[o(i(Ie(te.id).status==="available"?"mdi-check-circle":Ie(te.id).status==="unavailable"?"mdi-alert-circle":"mdi-clock-outline"),1)]),_:2},1024),o(" "+i(Tt(Ie(te.id).status)),1)]),_:2},1040,["color"])]),default:e(()=>[Ie(te.id).status==="unavailable"?(a(),f("span",Da,i(Ie(te.id).error),1)):(a(),f("span",Aa,i(Tt(Ie(te.id).status)),1))]),_:2},1024)):O("",!0)]),actions:e(({item:te})=>[t(T,{style:{"z-index":"100000"},variant:"tonal",color:"info",rounded:"xl",size:"small",loading:lt(te.id),onClick:ne=>Ht(te)},{default:e(()=>[o(i(u(n)("availability.test")),1)]),_:2},1032,["loading","onClick"])]),_:2},1032,["item","loading","onToggleEnabled","bglogo","onDelete"])]),_:2},1024))),128))]),_:1}))],64))])]),_:1}),t(la,{show:We.value,"onUpdate:show":R[3]||(R[3]=F=>We.value=F),metadata:u(B),onSelectTemplate:z},null,8,["show","metadata"]),t(Ve,{modelValue:Xe.value,"onUpdate:modelValue":R[6]||(R[6]=F=>Xe.value=F),"max-width":"400"},{default:e(()=>[t(me,{title:u(n)("models.manualDialogTitle")},{default:e(()=>[t(ce,{class:"py-4"},{default:e(()=>[t(_e,{modelValue:u(H),"onUpdate:modelValue":R[4]||(R[4]=F=>bt(H)?H.value=F:null),label:u(n)("models.manualDialogModelLabel"),flat:"",variant:"solo-filled",autofocus:"",clearable:""},null,8,["modelValue","label"]),t(_e,{"model-value":u(K),flat:"",variant:"solo-filled",label:u(n)("models.manualDialogPreviewLabel"),"persistent-hint":"",hint:u(n)("models.manualDialogPreviewHint")},null,8,["model-value","label","hint"])]),_:1}),t(ke,{class:"pa-4"},{default:e(()=>[t(pe),t(T,{variant:"text",onClick:R[5]||(R[5]=F=>Xe.value=!1)},{default:e(()=>[o("å–æ¶ˆ")]),_:1}),t(T,{color:"primary",onClick:c},{default:e(()=>[o("æ·»åŠ ")]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),t(Ve,{modelValue:ze.value,"onUpdate:modelValue":R[8]||(R[8]=F=>ze.value=F),width:"900",persistent:""},{default:e(()=>[t(me,{title:Oe.value?u(n)("dialogs.config.editTitle"):u(n)("dialogs.config.addTitle")+` ${Re.value} `+u(n)("dialogs.config.provider")},{default:e(()=>[t(ce,{class:"py-4"},{default:e(()=>[t(rt,{iterable:Be.value,metadata:u(B),metadataKey:"provider","is-editing":Oe.value},null,8,["iterable","metadata","is-editing"])]),_:1}),t(Me),t(ke,{class:"pa-4"},{default:e(()=>[t(pe),t(T,{variant:"text",onClick:R[7]||(R[7]=F=>ze.value=!1),disabled:Ke.value},{default:e(()=>[o(i(u(n)("dialogs.config.cancel")),1)]),_:1},8,["disabled"]),t(T,{color:"primary",onClick:X,loading:Ke.value},{default:e(()=>[o(i(u(n)("dialogs.config.save")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),t(Ve,{modelValue:Se.value,"onUpdate:modelValue":R[10]||(R[10]=F=>Se.value=F),width:"800"},{default:e(()=>{var F;return[t(me,{title:((F=Ce.value)==null?void 0:F.id)||u(n)("dialogs.config.editTitle")},{default:e(()=>[t(ce,{class:"py-4"},{default:e(()=>[Ba,Ce.value?(a(),_(rt,{key:0,iterable:Ce.value,metadata:u(B),metadataKey:"provider","is-editing":!0},null,8,["iterable","metadata"])):O("",!0)]),_:1}),t(ke,{class:"pa-4"},{default:e(()=>{var oe,te;return[t(pe),t(T,{variant:"text",onClick:R[9]||(R[9]=ne=>Se.value=!1),disabled:Le.value.includes((oe=Ce.value)==null?void 0:oe.id)},{default:e(()=>[o(i(u(n)("dialogs.config.cancel")),1)]),_:1},8,["disabled"]),t(T,{color:"primary",onClick:fe,loading:Le.value.includes((te=Ce.value)==null?void 0:te.id)},{default:e(()=>[o(i(u(n)("dialogs.config.save")),1)]),_:1},8,["loading"])]}),_:1})]),_:1},8,["title"])]}),_:1},8,["modelValue"]),t(ll,{modelValue:s.value.show,"onUpdate:modelValue":R[11]||(R[11]=F=>s.value.show=F),color:s.value.color,timeout:3e3,location:"top"},{default:e(()=>[o(i(s.value.message),1)]),_:1},8,["modelValue","color"]),t(Ve,{modelValue:Ne.value,"onUpdate:modelValue":R[13]||(R[13]=F=>Ne.value=F),"max-width":"520",persistent:""},{default:e(()=>[t(me,null,{default:e(()=>[t(Pe,{class:"text-h3 d-flex align-center"},{default:e(()=>[t(Y,{start:"",class:"me-2"},{default:e(()=>[o("mdi-information")]),_:1}),o(" è¯·å‰å¾€ã€Œé…ç½®æ–‡ä»¶ã€é¡µæµ‹è¯• Agent æ‰§è¡Œå™¨ ")]),_:1}),t(ce,{class:"py-4 text-body-1 text-medium-emphasis"},{default:e(()=>[o(" Agent æ‰§è¡Œå™¨çš„æµ‹è¯•è¯·åœ¨ã€Œé…ç½®æ–‡ä»¶ã€é¡µè¿›è¡Œã€‚ "),Ka,o(" è¦è®©æœºå™¨äººåº”ç”¨è¿™ä¸ª Agent æ‰§è¡Œå™¨ï¼Œä½ ä¹Ÿéœ€è¦å‰å¾€ä¿®æ”¹ Agent æ‰§è¡Œå™¨ã€‚ ")]),_:1}),t(ke,null,{default:e(()=>[t(pe),t(T,{color:"grey",variant:"text",onClick:R[12]||(R[12]=F=>Ne.value=!1)},{default:e(()=>[o("å¥½çš„")]),_:1}),t(T,{color:"primary",variant:"flat",onClick:Gt},{default:e(()=>[o("ç‚¹å‡»å‰å¾€")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},qt=Ue(La,[["__scopeId","data-v-dc517db4"]]),Ii=Object.freeze(Object.defineProperty({__proto__:null,default:qt},Symbol.toStringTag,{value:"Module"}));const Na={class:"d-flex align-center justify-space-between"},Fa={key:0,style:{color:"rgb(var(--v-theme-primaryText))"}},Ma={key:1},Ja={key:0},Ra={key:2,class:"text-center py-8"},qa={class:"text-grey mt-4"},Ha={class:"provider-drawer-header"},Wa={class:"provider-drawer-content"},Ga={__name:"ProviderSelector",props:{modelValue:{type:String,default:""},providerType:{type:String,default:"chat_completion"},providerSubtype:{type:String,default:""},buttonText:{type:String,default:"é€‰æ‹©æä¾›å•†..."}},emits:["update:modelValue"],setup(l,{emit:h}){const n=l,{tm:g}=ot("core.shared"),s=V(!1),y=V([]),k=V(!1),p=V(""),m=V(!1),q=ie(()=>n.providerType==="agent_runner"&&n.providerSubtype?`select_agent_runner_provider:${n.providerSubtype}`:n.providerType||"chat_completion");Ae(()=>n.modelValue,S=>{p.value=S||""},{immediate:!0}),Ae(m,(S,E)=>{!S&&E&&G()});async function x(){p.value=n.modelValue||"",s.value=!0,await G()}async function G(){k.value=!0;try{const S=await se.get("/api/config/provider/list",{params:{provider_type:n.providerType}});if(S.data.status==="ok"){const E=S.data.data||[];y.value=n.providerSubtype?E.filter(L=>A(L,n.providerSubtype)):E}}catch(S){console.error("åŠ è½½æä¾›å•†åˆ—è¡¨å¤±è´¥:",S),y.value=[]}finally{k.value=!1}}function A(S,E){if(!E)return!0;const L=String(E).toLowerCase();return[S.type,S.provider,S.id].filter(Boolean).map(U=>String(U).toLowerCase()).includes(L)}function N(S){p.value=S.id}function B(){h("update:modelValue",p.value),s.value=!1}function H(){p.value=n.modelValue||"",s.value=!1}function j(){m.value=!0}function C(){m.value=!1}return(S,E)=>(a(),f(Q,null,[$("div",Na,[l.modelValue?(a(),f("span",Ma,i(l.modelValue),1)):(a(),f("span",Fa,i(u(g)("providerSelector.notSelected")),1)),t(T,{size:"small",color:"primary",variant:"tonal",onClick:x},{default:e(()=>[o(i(l.buttonText),1)]),_:1})]),t(Ve,{modelValue:s.value,"onUpdate:modelValue":E[1]||(E[1]=L=>s.value=L),"max-width":"600px"},{default:e(()=>[t(me,null,{default:e(()=>[t(Pe,{class:"text-h3 py-4 d-flex align-center justify-space-between gap-4 flex-wrap",style:{"font-weight":"normal"}},{default:e(()=>[$("span",null,i(u(g)("providerSelector.dialogTitle")),1),t(T,{size:"small",color:"primary",variant:"tonal","prepend-icon":"mdi-plus",onClick:j},{default:e(()=>[o(i(u(g)("providerSelector.createProvider")),1)]),_:1})]),_:1}),t(ce,{class:"pa-0",style:{"max-height":"400px","overflow-y":"auto"}},{default:e(()=>[k.value?(a(),_(pt,{key:0,indeterminate:"",color:"primary"})):O("",!0),!k.value&&y.value.length>0?(a(),_(qe,{key:1,density:"compact"},{default:e(()=>[t($e,{key:"none",value:"",onClick:E[0]||(E[0]=L=>N({id:""})),active:p.value==="",rounded:"md",class:"ma-1"},{append:e(()=>[p.value===""?(a(),_(Y,{key:0,color:"primary"},{default:e(()=>[o("mdi-check-circle")]),_:1})):O("",!0)]),default:e(()=>[t(he,null,{default:e(()=>[o(i(u(g)("providerSelector.clearSelection")),1)]),_:1}),t(xe,null,{default:e(()=>[o(i(u(g)("providerSelector.clearSelectionSubtitle")),1)]),_:1})]),_:1},8,["active"]),t(Me,{class:"ma-1"}),(a(!0),f(Q,null,ve(y.value,L=>(a(),_($e,{key:L.id,value:L.id,onClick:I=>N(L),active:p.value===L.id,rounded:"md",class:"ma-1"},{append:e(()=>[p.value===L.id?(a(),_(Y,{key:0,color:"primary"},{default:e(()=>[o("mdi-check-circle")]),_:1})):O("",!0)]),default:e(()=>[t(he,null,{default:e(()=>[o(i(L.id),1)]),_:2},1024),t(xe,null,{default:e(()=>[o(i(L.type||L.provider_type||u(g)("providerSelector.unknownType"))+" ",1),L.model?(a(),f("span",Ja,"- "+i(L.model),1)):O("",!0)]),_:2},1024)]),_:2},1032,["value","onClick","active"]))),128))]),_:1})):!k.value&&y.value.length===0?(a(),f("div",Ra,[t(Y,{size:"64",color:"grey-lighten-1"},{default:e(()=>[o("mdi-api-off")]),_:1}),$("p",qa,i(u(g)("providerSelector.noProviders")),1)])):O("",!0)]),_:1}),t(Me),t(ke,{class:"pa-4"},{default:e(()=>[t(pe),t(T,{variant:"text",onClick:H},{default:e(()=>[o(i(u(g)("providerSelector.cancelSelection")),1)]),_:1}),t(T,{color:"primary",onClick:B},{default:e(()=>[o(i(u(g)("providerSelector.confirmSelection")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(sl,{modelValue:m.value,"onUpdate:modelValue":E[2]||(E[2]=L=>m.value=L),class:"provider-drawer-overlay",location:"right",transition:"slide-x-reverse-transition",scrim:!0,"onClick:outside":C},{default:e(()=>[t(me,{class:"provider-drawer-card",elevation:"12"},{default:e(()=>[$("div",Ha,[t(T,{icon:"",variant:"text",onClick:C},{default:e(()=>[t(Y,null,{default:e(()=>[o("mdi-close")]),_:1})]),_:1})]),$("div",Wa,[t(qt,{"default-tab":q.value},null,8,["default-tab"])])]),_:1})]),_:1},8,["modelValue"])],64))}},nt=Ue(Ga,[["__scopeId","data-v-fede6bff"]]);const Ya=l=>(vt("data-v-a9c38aa5"),l=l(),ft(),l),Za={class:"d-flex align-center justify-space-between"},Qa={key:0,style:{color:"rgb(var(--v-theme-primaryText))"}},Xa={key:1},eo={key:2,class:"text-center py-8"},to=Ya(()=>$("p",{class:"text-grey mt-4"},"æš‚æ— å¯ç”¨çš„äººæ ¼",-1)),lo={__name:"PersonaSelector",props:{modelValue:{type:String,default:""},buttonText:{type:String,default:"é€‰æ‹©äººæ ¼..."}},emits:["update:modelValue"],setup(l,{emit:h}){const n=l,g=V(!1),s=V([]),y=V(!1),k=V(""),p=V(!1);Ae(()=>n.modelValue,j=>{k.value=j||""},{immediate:!0});async function m(){k.value=n.modelValue||"",g.value=!0,await q()}async function q(){y.value=!0;try{const j=await se.get("/api/persona/list");if(j.data.status==="ok"){const C=j.data.data||[];s.value=[{persona_id:"default",system_prompt:"You are a helpful and friendly assistant."},...C]}}catch(j){console.error("åŠ è½½äººæ ¼åˆ—è¡¨å¤±è´¥:",j),s.value=[{persona_id:"default",system_prompt:"You are a helpful and friendly assistant."}]}finally{y.value=!1}}function x(j){k.value=j.persona_id}function G(){h("update:modelValue",k.value),g.value=!1}function A(){k.value=n.modelValue||"",g.value=!1}function N(){p.value=!0}async function B(j){console.log("äººæ ¼åˆ›å»ºæˆåŠŸ:",j),p.value=!1,await q()}function H(j){console.error("åˆ›å»ºäººæ ¼å¤±è´¥:",j)}return(j,C)=>(a(),f(Q,null,[$("div",Za,[l.modelValue?(a(),f("span",Xa,i(l.modelValue==="default"?"é»˜è®¤äººæ ¼":l.modelValue),1)):(a(),f("span",Qa," æœªé€‰æ‹© ")),t(T,{size:"small",color:"primary",variant:"tonal",onClick:m},{default:e(()=>[o(i(l.buttonText),1)]),_:1})]),t(Ve,{modelValue:g.value,"onUpdate:modelValue":C[0]||(C[0]=S=>g.value=S),"max-width":"600px"},{default:e(()=>[t(me,null,{default:e(()=>[t(Pe,{class:"text-h3 py-4",style:{"font-weight":"normal"}},{default:e(()=>[o(" é€‰æ‹©äººæ ¼ ")]),_:1}),t(ce,{class:"pa-2",style:{"max-height":"400px","overflow-y":"auto"}},{default:e(()=>[y.value?(a(),_(pt,{key:0,indeterminate:"",color:"primary"})):O("",!0),!y.value&&s.value.length>0?(a(),_(qe,{key:1,density:"compact"},{default:e(()=>[(a(!0),f(Q,null,ve(s.value,S=>(a(),_($e,{key:S.persona_id,value:S.persona_id,onClick:E=>x(S),active:k.value===S.persona_id,rounded:"md",class:"ma-1"},{append:e(()=>[k.value===S.persona_id?(a(),_(Y,{key:0,color:"primary"},{default:e(()=>[o("mdi-check-circle")]),_:1})):O("",!0)]),default:e(()=>[t(he,null,{default:e(()=>[o(i(S.persona_id==="default"?"é»˜è®¤äººæ ¼":S.persona_id),1)]),_:2},1024),t(xe,null,{default:e(()=>[o(i(S.system_prompt?S.system_prompt.substring(0,50)+"...":"æ— æè¿°"),1)]),_:2},1024)]),_:2},1032,["value","onClick","active"]))),128))]),_:1})):!y.value&&s.value.length===0?(a(),f("div",eo,[t(Y,{size:"64",color:"grey-lighten-1"},{default:e(()=>[o("mdi-account-off")]),_:1}),to])):O("",!0)]),_:1}),t(ke,{class:"pa-4"},{default:e(()=>[t(T,{variant:"text",color:"primary","prepend-icon":"mdi-plus",onClick:N},{default:e(()=>[o(" åˆ›å»ºæ–°äººæ ¼ ")]),_:1}),t(pe),t(T,{variant:"text",onClick:A},{default:e(()=>[o("å–æ¶ˆ")]),_:1}),t(T,{color:"primary",onClick:G,disabled:!k.value},{default:e(()=>[o(" ç¡®è®¤é€‰æ‹© ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(pl,{modelValue:p.value,"onUpdate:modelValue":C[1]||(C[1]=S=>p.value=S),"editing-persona":null,"mcp-servers":j.mcpServers,"available-tools":j.availableTools,"loading-tools":j.loadingTools,onSaved:B,onError:H},null,8,["modelValue","mcp-servers","available-tools","loading-tools"])],64))}},Et=Ue(lo,[["__scopeId","data-v-a9c38aa5"]]);const ao={class:"d-flex align-center justify-space-between",style:{gap:"8px"}},oo={style:{flex:"1","min-width":"0",overflow:"hidden"}},io={key:0,style:{color:"rgb(var(--v-theme-primaryText))"}},no={key:1,class:"d-flex flex-wrap gap-1"},so={class:"text-truncate",style:{"max-width":"200px"}},ro={class:"emoji-icon"},uo={key:0},co={key:1},mo={key:0,class:"text-center py-8"},vo={class:"text-grey mt-4 mb-4"},fo={key:0,class:"text-caption text-grey"},po={__name:"KnowledgeBaseSelector",props:{modelValue:{type:Array,default:()=>[]},buttonText:{type:String,default:"é€‰æ‹©çŸ¥è¯†åº“..."}},emits:["update:modelValue"],setup(l,{emit:h}){const n=l,g=Nt(),{tm:s}=ot("core.shared"),y=V(!1),k=V([]),p=V(!1),m=V([]);Ae(()=>n.modelValue,C=>{m.value=Array.isArray(C)?[...C]:[]},{immediate:!0});async function q(){m.value=Array.isArray(n.modelValue)?[...n.modelValue]:[],y.value=!0,await x()}async function x(){p.value=!0;try{const C=await se.get("/api/kb/list",{params:{page:1,page_size:100}});C.data.status==="ok"?k.value=C.data.data.items||[]:(console.error("åŠ è½½çŸ¥è¯†åº“åˆ—è¡¨å¤±è´¥:",C.data.message),k.value=[])}catch(C){console.error("åŠ è½½çŸ¥è¯†åº“åˆ—è¡¨å¤±è´¥:",C),k.value=[]}finally{p.value=!1}}function G(C){return m.value.includes(C)}function A(C){const S=m.value.indexOf(C);S>-1?m.value.splice(S,1):m.value.push(C)}function N(C){const S=m.value.indexOf(C);S>-1&&m.value.splice(S,1),h("update:modelValue",[...m.value])}function B(){h("update:modelValue",[...m.value]),y.value=!1}function H(){m.value=Array.isArray(n.modelValue)?[...n.modelValue]:[],y.value=!1}function j(){y.value=!1,g.push("/knowledge-base")}return(C,S)=>(a(),f(Q,null,[$("div",ao,[$("div",oo,[!l.modelValue||Array.isArray(l.modelValue)&&l.modelValue.length===0?(a(),f("span",io,i(u(s)("knowledgeBaseSelector.notSelected")),1)):(a(),f("div",no,[(a(!0),f(Q,null,ve(l.modelValue,E=>(a(),_(Ye,{key:E,size:"small",color:"primary",variant:"tonal",closable:"","onClick:close":L=>N(E),style:{"max-width":"100%"}},{default:e(()=>[$("span",so,i(E),1)]),_:2},1032,["onClick:close"]))),128))]))]),t(T,{size:"small",color:"primary",variant:"tonal",onClick:q,style:{"flex-shrink":"0"}},{default:e(()=>[o(i(l.buttonText),1)]),_:1})]),t(Ve,{modelValue:y.value,"onUpdate:modelValue":S[0]||(S[0]=E=>y.value=E),"max-width":"600px"},{default:e(()=>[t(me,null,{default:e(()=>[t(Pe,{class:"text-h3 py-4",style:{"font-weight":"normal"}},{default:e(()=>[o(i(u(s)("knowledgeBaseSelector.dialogTitle")),1)]),_:1}),t(ce,{class:"pa-0",style:{"max-height":"400px","overflow-y":"auto"}},{default:e(()=>[p.value?(a(),_(pt,{key:0,indeterminate:"",color:"primary"})):O("",!0),p.value?O("",!0):(a(),_(qe,{key:1,density:"compact"},{default:e(()=>[(a(!0),f(Q,null,ve(k.value,E=>(a(),_($e,{key:E.kb_id,value:E.kb_name,onClick:L=>A(E.kb_name),active:G(E.kb_name),rounded:"md",class:"ma-1"},{prepend:e(()=>[$("span",ro,i(E.emoji||"ğŸ“š"),1)]),append:e(()=>[G(E.kb_name)?(a(),_(Y,{key:0,color:"primary"},{default:e(()=>[o(" mdi-checkbox-marked ")]),_:1})):(a(),_(Y,{key:1,color:"grey-lighten-1"},{default:e(()=>[o(" mdi-checkbox-blank-outline ")]),_:1}))]),default:e(()=>[t(he,null,{default:e(()=>[o(i(E.kb_name),1)]),_:2},1024),t(xe,null,{default:e(()=>[o(i(E.description||u(s)("knowledgeBaseSelector.noDescription"))+" ",1),E.doc_count!==void 0?(a(),f("span",uo," - "+i(u(s)("knowledgeBaseSelector.documentCount",{count:E.doc_count})),1)):O("",!0),E.chunk_count!==void 0?(a(),f("span",co," - "+i(u(s)("knowledgeBaseSelector.chunkCount",{count:E.chunk_count})),1)):O("",!0)]),_:2},1024)]),_:2},1032,["value","onClick","active"]))),128)),k.value.length===0?(a(),f("div",mo,[t(Y,{size:"64",color:"grey-lighten-1"},{default:e(()=>[o("mdi-database-off")]),_:1}),$("p",vo,i(u(s)("knowledgeBaseSelector.noKnowledgeBases")),1),t(T,{color:"primary",variant:"tonal",onClick:j},{default:e(()=>[o(i(u(s)("knowledgeBaseSelector.createKnowledgeBase")),1)]),_:1})])):O("",!0)]),_:1}))]),_:1}),t(ke,{class:"pa-4"},{default:e(()=>[m.value.length>0?(a(),f("div",fo,i(u(s)("knowledgeBaseSelector.selectedCount",{count:m.value.length})),1)):O("",!0),t(pe),t(T,{variant:"text",onClick:H},{default:e(()=>[o(i(u(s)("knowledgeBaseSelector.cancelSelection")),1)]),_:1}),t(T,{color:"primary",onClick:B},{default:e(()=>[o(i(u(s)("knowledgeBaseSelector.confirmSelection")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},go=Ue(po,[["__scopeId","data-v-5bd48de9"]]);const yo={class:"d-flex align-center justify-space-between mb-2"},ho={class:"flex-grow-1"},bo={key:0,style:{color:"rgb(var(--v-theme-primaryText))"}},_o={key:1,style:{color:"rgb(var(--v-theme-primaryText))"}},xo={key:2,style:{color:"rgb(var(--v-theme-primaryText))"}},ko={key:1},Vo={key:0,style:{"max-height":"300px","overflow-y":"auto"}},wo={class:"pl-8 pt-2"},So={key:1,class:"text-center py-8"},Co={class:"text-grey mt-4"},Po={__name:"PluginSetSelector",props:{modelValue:{type:Array,default:()=>[]},buttonText:{type:String,default:"é€‰æ‹©æ’ä»¶é›†åˆ..."},maxDisplayItems:{type:Number,default:3}},emits:["update:modelValue"],setup(l,{emit:h}){const n=l,{tm:g}=ot("core.shared"),s=V(!1),y=V([]),k=V(!1),p=V("custom"),m=V([]),q=ie(()=>n.modelValue&&n.modelValue.length===1&&n.modelValue[0]==="*");Ae(()=>n.modelValue,B=>{!B||B.length===0?(p.value="none",m.value=[]):B.length===1&&B[0]==="*"?(p.value="all",m.value=[]):(p.value="custom",m.value=[...B])},{immediate:!0});async function x(){s.value=!0,await G()}async function G(){k.value=!0;try{const B=await se.get("/api/plugin/get");B.data.status==="ok"&&(y.value=(B.data.data||[]).filter(H=>H.activated&&!H.reserved).sort((H,j)=>H.name.localeCompare(j.name)))}catch(B){console.error("åŠ è½½æ’ä»¶åˆ—è¡¨å¤±è´¥:",B),y.value=[]}finally{k.value=!1}}function A(){let B=[];switch(p.value){case"all":B=["*"];break;case"none":B=[];break;case"custom":B=[...m.value];break}h("update:modelValue",B),s.value=!1}function N(){const B=n.modelValue||[];B.length===0?(p.value="none",m.value=[]):B.length===1&&B[0]==="*"?(p.value="all",m.value=[]):(p.value="custom",m.value=[...B]),s.value=!1}return(B,H)=>(a(),f(Q,null,[$("div",null,[$("div",yo,[$("div",ho,[!l.modelValue||l.modelValue.length===0?(a(),f("span",bo,i(u(g)("pluginSetSelector.notSelected")),1)):q.value?(a(),f("span",_o,i(u(g)("pluginSetSelector.allPlugins")),1)):(a(),f("span",xo,i(u(g)("pluginSetSelector.selectedCount",{count:l.modelValue.length})),1))]),t(T,{size:"small",color:"primary",variant:"tonal",onClick:x},{default:e(()=>[o(i(l.buttonText),1)]),_:1})])]),t(Ve,{modelValue:s.value,"onUpdate:modelValue":H[2]||(H[2]=j=>s.value=j),"max-width":"700px"},{default:e(()=>[t(me,null,{default:e(()=>[t(Pe,{class:"text-h3 py-4",style:{"font-weight":"normal"}},{default:e(()=>[o(i(u(g)("pluginSetSelector.dialogTitle")),1)]),_:1}),t(ce,{class:"pa-4"},{default:e(()=>[k.value?(a(),_(pt,{key:0,indeterminate:"",color:"primary"})):O("",!0),k.value?O("",!0):(a(),f("div",ko,[t(dl,{modelValue:p.value,"onUpdate:modelValue":H[0]||(H[0]=j=>p.value=j),class:"mb-4","hide-details":""},{default:e(()=>[t(_t,{value:"all",label:u(g)("pluginSetSelector.enableAll"),color:"primary"},null,8,["label"]),t(_t,{value:"none",label:u(g)("pluginSetSelector.enableNone"),color:"primary"},null,8,["label"]),t(_t,{value:"custom",label:u(g)("pluginSetSelector.customSelect"),color:"primary"},null,8,["label"])]),_:1},8,["modelValue"]),p.value==="custom"?(a(),f("div",Vo,[y.value.length>0?(a(),_(qe,{key:0,density:"compact"},{default:e(()=>[(a(!0),f(Q,null,ve(y.value,j=>(a(),_($e,{key:j.name,rounded:"md",class:"ma-1"},{prepend:e(()=>[t(Ft,{modelValue:m.value,"onUpdate:modelValue":H[1]||(H[1]=C=>m.value=C),value:j.name,color:"primary","hide-details":""},null,8,["modelValue","value"])]),default:e(()=>[t(he,null,{default:e(()=>[o(i(j.name),1)]),_:2},1024),t(xe,null,{default:e(()=>[o(i(j.desc||u(g)("pluginSetSelector.noDescription"))+" ",1),j.activated?O("",!0):(a(),_(Ye,{key:0,size:"x-small",color:"grey",class:"ml-1"},{default:e(()=>[o(i(u(g)("pluginSetSelector.notActivated")),1)]),_:1}))]),_:2},1024)]),_:2},1024))),128)),$("div",wo,[$("small",null,i(u(g)("pluginSetSelector.note")),1)])]),_:1})):(a(),f("div",So,[t(Y,{size:"64",color:"grey-lighten-1"},{default:e(()=>[o("mdi-puzzle-outline")]),_:1}),$("p",Co,i(u(g)("pluginSetSelector.noPlugins")),1)]))])):O("",!0)]))]),_:1}),t(ke,{class:"pa-4"},{default:e(()=>[t(pe),t(T,{variant:"text",onClick:N},{default:e(()=>[o(i(u(g)("pluginSetSelector.cancelSelection")),1)]),_:1}),t(T,{color:"primary",onClick:A},{default:e(()=>[o(i(u(g)("pluginSetSelector.confirmSelection")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},$o=Ue(Po,[["__scopeId","data-v-78c995ac"]]);const $t=l=>(vt("data-v-a373ce1b"),l=l(),ft(),l),To=$t(()=>$("span",null,"è‡ªå®šä¹‰æ–‡è½¬å›¾ HTML æ¨¡æ¿",-1)),Io={class:"d-flex align-center gap-2",style:{width:"60%"}},Uo={class:"d-flex align-center pa-1",style:{border:"1px solid rgba(0,0,0,0.1)","border-radius":"8px"}},jo={class:"flex-grow-1",style:{"border-right":"1px solid rgba(0,0,0,0.1)"}},Eo={class:"flex-grow-1 preview-container"},zo=["srcdoc"],Oo={class:"text-caption text-grey"},Do=$t(()=>$("code",null," text | safe ",-1)),Ao=$t(()=>$("code",null," version ",-1)),Bo={__name:"T2ITemplateEditor",setup(l,{expose:h}){tt();const n=V(!1),g=V(!1),s=V(!1),y=V(!1),k=V(!1),p=V(!1),m=V([]),q=V("base"),x=V(null),G=V(""),A=V(""),N=V(!1),B=V(!1),H=V(!1),j=V(!1),C=V(null),S=ie(()=>"vs-light"),E={automaticLayout:!0,fontSize:12,lineNumbers:"on",wordWrap:"on",minimap:{enabled:!1},scrollBeyondLastLine:!1},L={text:`è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ–‡æœ¬ï¼Œç”¨äºé¢„è§ˆæ¨¡æ¿æ•ˆæœã€‚

è¿™é‡Œå¯ä»¥åŒ…å«å¤šè¡Œæ–‡æœ¬ï¼Œæ”¯æŒæ¢è¡Œå’Œå„ç§æ ¼å¼ã€‚`,version:"v4.0.0"},I=ie(()=>{try{let W=A.value;return W=W.replace(/\{\{\s*text\s*\|\s*safe\s*\}\}/g,L.text),W=W.replace(/\{\{\s*version\s*\}\}/g,L.version),W}catch(W){return`<div style="color: red; padding: 20px;">æ¨¡æ¿æ¸²æŸ“é”™è¯¯: ${W.message}</div>`}}),U=async()=>{g.value=!0;try{const[W,Z]=await Promise.all([se.get("/api/t2i/templates"),se.get("/api/t2i/templates/active")]);W.data.status==="ok"?m.value=W.data.data:console.error("åŠ è½½æ¨¡æ¿åˆ—è¡¨å¤±è´¥:",W.data.message),Z.data.status==="ok"?q.value=Z.data.data.active_template:console.error("åŠ è½½æ´»åŠ¨æ¨¡æ¿å¤±è´¥:",Z.data.message),m.value.length>0&&(x.value=q.value)}catch(W){console.error("åŠ è½½åˆå§‹æ•°æ®å¤±è´¥:",W)}finally{g.value=!1}},v=async W=>{if(W){k.value=!0;try{const Z=await se.get(`/api/t2i/templates/${W}`);Z.data.status==="ok"?A.value=Z.data.data.content:console.error(`åŠ è½½æ¨¡æ¿ '${W}' å¤±è´¥:`,Z.data.message)}catch(Z){console.error(`åŠ è½½æ¨¡æ¿ '${W}' å¤±è´¥:`,Z)}finally{k.value=!1}}},K=async()=>{s.value=!0;try{if(N.value){if(!G.value)return;const W=await se.post("/api/t2i/templates/create",{name:G.value,content:A.value});await U(),x.value=W.data.data.name,N.value=!1}else{if(!x.value)return;await se.put(`/api/t2i/templates/${x.value}`,{content:A.value})}}catch(W){console.error("ä¿å­˜æ¨¡æ¿å¤±è´¥:",W)}finally{s.value=!1}},r=async W=>{p.value=!0;try{await se.post("/api/t2i/templates/set_active",{name:W}),q.value=W}catch(Z){console.error(`åº”ç”¨æ¨¡æ¿ '${W}' å¤±è´¥:`,Z)}finally{p.value=!1}},b=async()=>{if(!(!x.value||x.value==="base")){s.value=!0;try{const W=x.value;await se.delete(`/api/t2i/templates/${W}`),H.value=!1,q.value===W&&await r("base"),await U(),x.value="base"}catch(W){console.error(`åˆ é™¤æ¨¡æ¿ '${x.value}' å¤±è´¥:`,W)}finally{s.value=!1}}},d=async()=>{y.value=!0;try{await se.post("/api/t2i/templates/reset_default"),B.value=!1,x.value==="base"&&await v("base"),q.value!=="base"&&await r("base")}catch(W){console.error("é‡ç½®æ¨¡æ¿å¤±è´¥:",W)}finally{y.value=!1}},w=()=>{B.value=!0},D=()=>{N.value=!0,x.value=null,G.value="",A.value=`<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>New Template</title>
</head>
<body>
  <!-- ä»è¿™é‡Œå¼€å§‹ç¼–è¾‘ -->
  <article>{{ text | safe }}</article>
</body>
</html>
`},ge=()=>{x.value&&x.value!=="base"&&(H.value=!0)},Te=()=>{!N.value&&x.value&&(j.value=!0)},de=async()=>{N.value||(await K(),await r(x.value),j.value=!1,ye())},re=()=>{k.value=!0,kt(()=>{C.value&&C.value.contentWindow.location.reload(),setTimeout(()=>k.value=!1,500)})},ye=()=>{n.value=!1};return Ae(n,W=>{W?U():(x.value=null,A.value="",N.value=!1)}),Ae(x,W=>{W&&(N.value=!1,v(W))}),h({openDialog:()=>{n.value=!0}}),(W,Z)=>(a(),_(Ve,{modelValue:n.value,"onUpdate:modelValue":Z[9]||(Z[9]=ae=>n.value=ae),"max-width":"1400px",persistent:"",scrollable:""},{activator:e(({props:ae})=>[t(T,Ze(ae,{variant:"outlined",color:"primary",size:"small",loading:g.value}),{default:e(()=>[o(" è‡ªå®šä¹‰ T2I æ¨¡æ¿ ")]),_:2},1040,["loading"])]),default:e(()=>[t(me,null,{default:e(()=>[t(Pe,{class:"d-flex align-center justify-space-between"},{default:e(()=>[To,t(pe),$("div",Io,[N.value?(a(),_(_e,{key:0,modelValue:G.value,"onUpdate:modelValue":Z[0]||(Z[0]=ae=>G.value=ae),label:"è¾“å…¥æ–°æ¨¡æ¿åç§°",density:"compact","hide-details":"",variant:"outlined",class:"flex-grow-1",autofocus:"",rules:[ae=>!!ae||"åç§°ä¸èƒ½ä¸ºç©º"]},null,8,["modelValue","rules"])):(a(),_(Ct,{key:1,modelValue:x.value,"onUpdate:modelValue":Z[1]||(Z[1]=ae=>x.value=ae),items:m.value,"item-title":"name","item-value":"name",label:"é€‰æ‹©æ¨¡æ¿",density:"compact","hide-details":"",variant:"outlined",class:"flex-grow-1",loading:g.value},{item:e(({props:ae,item:je})=>[t($e,Ze(ae,{title:je.raw.name}),{append:e(()=>[je.raw.name===q.value?(a(),_(Ye,{key:0,color:"success",variant:"tonal",size:"small",class:"ml-2"},{default:e(()=>[o(" å·²åº”ç”¨ ")]),_:1})):(a(),_(T,{key:1,variant:"text",color:"primary",size:"small",class:"ml-2",onClick:Fe(He=>r(je.raw.name),["stop"]),loading:p.value},{default:e(()=>[o(" åº”ç”¨ ")]),_:2},1032,["onClick","loading"]))]),_:2},1040,["title"])]),_:1},8,["modelValue","items","loading"])),t(T,{variant:"text",icon:"",onClick:ye},{default:e(()=>[t(Y,null,{default:e(()=>[o("mdi-close")]),_:1})]),_:1})])]),_:1}),t(ce,{class:"pa-0"},{default:e(()=>[t(Ee,{"no-gutters":"",style:{height:"70vh"}},{default:e(()=>[t(ue,{cols:"6",class:"d-flex flex-column"},{default:e(()=>[t(Vt,{density:"compact",color:"surface-variant"},{default:e(()=>[t(wt,{class:"text-subtitle-2"},{default:e(()=>[o("æ¨¡æ¿ç¼–è¾‘å™¨")]),_:1}),t(pe),$("div",Uo,[t(T,{variant:"text",size:"small",onClick:D,color:"success"},{default:e(()=>[t(Y,{left:""},{default:e(()=>[o("mdi-plus")]),_:1}),o(" æ–°å»º ")]),_:1}),t(Me,{vertical:"",class:"mx-1"}),t(T,{variant:"text",size:"small",onClick:w,loading:y.value,color:"warning"},{default:e(()=>[o(" é‡ç½®Base ")]),_:1},8,["loading"]),t(T,{variant:"text",size:"small",onClick:ge,color:"error",disabled:N.value||x.value==="base"||!x.value},{default:e(()=>[o(" åˆ é™¤ ")]),_:1},8,["disabled"]),t(Me,{vertical:"",class:"mx-1"}),t(T,{variant:"text",size:"small",onClick:K,loading:s.value,color:"primary",disabled:N.value&&!G.value||!N.value&&!x.value},{default:e(()=>[o(" ä¿å­˜ ")]),_:1},8,["loading","disabled"])])]),_:1}),$("div",jo,[t(u(St),{value:A.value,"onUpdate:value":Z[2]||(Z[2]=ae=>A.value=ae),theme:S.value,language:"html",options:E,style:{height:"100%"}},null,8,["value","theme"])])]),_:1}),t(ue,{cols:"6",class:"d-flex flex-column"},{default:e(()=>[t(Vt,{density:"compact",color:"surface-variant"},{default:e(()=>[t(wt,{class:"text-subtitle-2"},{default:e(()=>[o("å®æ—¶é¢„è§ˆ(å¯èƒ½æœ‰å·®å¼‚)")]),_:1}),t(pe),t(T,{variant:"text",size:"small",onClick:re,loading:k.value},{default:e(()=>[o(" åˆ·æ–°é¢„è§ˆ ")]),_:1},8,["loading"])]),_:1}),$("div",Eo,[$("iframe",{ref_key:"previewFrame",ref:C,srcdoc:I.value,style:{width:"100%",height:"100%",border:"none",zoom:"0.6"}},null,8,zo)])]),_:1})]),_:1})]),_:1}),t(ke,{class:"px-6 py-4"},{default:e(()=>[t(Ee,{"no-gutters":"",class:"align-center"},{default:e(()=>[t(ue,null,{default:e(()=>[$("div",Oo,[t(Y,{size:"16",class:"mr-1"},{default:e(()=>[o("mdi-information")]),_:1}),o(" æ”¯æŒ jinja2 è¯­æ³•ã€‚å¯ç”¨å˜é‡ï¼š"),Do,o("ï¼ˆè¦æ¸²æŸ“çš„æ–‡æœ¬ï¼‰, "),Ao,o("ï¼ˆAstrBot ç‰ˆæœ¬ï¼‰ ")])]),_:1}),t(ue,{cols:"auto"},{default:e(()=>[t(T,{variant:"text",onClick:ye},{default:e(()=>[o(" å–æ¶ˆ ")]),_:1}),t(T,{color:"primary",onClick:Te,loading:s.value,disabled:N.value||!x.value},{default:e(()=>[o(" ä¿å­˜åº”ç”¨å½“å‰ç¼–è¾‘æ¨¡æ¿ ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),t(Ve,{modelValue:B.value,"onUpdate:modelValue":Z[4]||(Z[4]=ae=>B.value=ae),"max-width":"400px"},{default:e(()=>[t(me,null,{default:e(()=>[t(Pe,null,{default:e(()=>[o("ç¡®è®¤é‡ç½®")]),_:1}),t(ce,null,{default:e(()=>[o(" ç¡®å®šè¦å°† 'base' æ¨¡æ¿æ¢å¤ä¸ºé»˜è®¤å†…å®¹å—ï¼Ÿå½“å‰ç¼–è¾‘å™¨ä¸­çš„ä»»ä½•æœªä¿å­˜æ›´æ”¹å°†ä¸¢å¤±ã€‚æ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚ ")]),_:1}),t(ke,null,{default:e(()=>[t(pe),t(T,{text:"",onClick:Z[3]||(Z[3]=ae=>B.value=!1)},{default:e(()=>[o("å–æ¶ˆ")]),_:1}),t(T,{color:"warning",onClick:d,loading:y.value},{default:e(()=>[o("ç¡®è®¤é‡ç½®")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Ve,{modelValue:H.value,"onUpdate:modelValue":Z[6]||(Z[6]=ae=>H.value=ae),"max-width":"400px"},{default:e(()=>[t(me,null,{default:e(()=>[t(Pe,null,{default:e(()=>[o("ç¡®è®¤åˆ é™¤")]),_:1}),t(ce,null,{default:e(()=>[o(" ç¡®å®šè¦åˆ é™¤æ¨¡æ¿ '"+i(x.value)+"' å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚ ",1)]),_:1}),t(ke,null,{default:e(()=>[t(pe),t(T,{text:"",onClick:Z[5]||(Z[5]=ae=>H.value=!1)},{default:e(()=>[o("å–æ¶ˆ")]),_:1}),t(T,{color:"error",onClick:b,loading:s.value},{default:e(()=>[o("ç¡®è®¤åˆ é™¤")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Ve,{modelValue:j.value,"onUpdate:modelValue":Z[8]||(Z[8]=ae=>j.value=ae),"max-width":"500px"},{default:e(()=>[t(me,null,{default:e(()=>[t(Pe,null,{default:e(()=>[o("ç¡®è®¤æ“ä½œ")]),_:1}),t(ce,null,{default:e(()=>[o(" ç¡®å®šè¦ä¿å­˜å¯¹ '"+i(x.value)+"' çš„ä¿®æ”¹ï¼Œå¹¶å°†å…¶è®¾ä¸ºæ–°çš„æ´»åŠ¨æ¨¡æ¿å—ï¼Ÿ ",1)]),_:1}),t(ke,null,{default:e(()=>[t(pe),t(T,{text:"",onClick:Z[7]||(Z[7]=ae=>j.value=!1)},{default:e(()=>[o("å–æ¶ˆ")]),_:1}),t(T,{color:"primary",onClick:de,loading:s.value},{default:e(()=>[o("ç¡®è®¤")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}},Ko=Ue(Bo,[["__scopeId","data-v-a373ce1b"]]);const Lo={class:"w-100"},No={key:10,class:"d-flex align-center gap-2"},Fo={key:11,class:"d-flex flex-wrap gap-20"},Mo={key:14,class:"editor-container"},Jo={key:16,class:"d-flex align-center gap-3"},Ro={__name:"ConfigItemRenderer",props:{modelValue:{type:[String,Number,Boolean,Array,Object],default:null},itemMeta:{type:Object,default:null},loading:{type:Boolean,default:!1},showFullscreenBtn:{type:Boolean,default:!1}},emits:["update:modelValue","get-embedding-dim","open-fullscreen"],setup(l,{emit:h}){const{t:n}=tt(),{getRaw:g}=ot("features/config-metadata");function s(A){h("update:modelValue",A)}function y(A){const N=parseFloat(A);return isNaN(N)?0:N}function k(A,N,B){const H=p(A);return H?H[N]:B}function p(A){if(!(A!=null&&A.labels))return null;if(typeof A.labels=="string"){const N=g(A.labels);if(Array.isArray(N))return N}return Array.isArray(A.labels)?A.labels:null}function m(A){const N=p(A);return N&&A.options?A.options.map((B,H)=>({title:N[H]||B,value:B})):A.options||[]}function q(A){if(!A||typeof A!="string")return{name:"",subtype:""};const[N,...B]=A.split(":");return{name:N,subtype:B.join(":")||""}}function x(A){return q(A).name}function G(A){return q(A).subtype}return(A,N)=>{var B,H,j,C,S,E,L,I,U,v,K,r,b,d,w,D,ge,Te,de,re,ye,W,Z,ae,je,He,Qe,Je,We,ze,Re,Be,Ge,Oe,Ke,we,Ne;return a(),f("div",Lo,[((B=l.itemMeta)==null?void 0:B._special)==="select_provider"?(a(),_(nt,{key:0,"model-value":l.modelValue,"onUpdate:modelValue":s,"provider-type":"chat_completion"},null,8,["model-value"])):((H=l.itemMeta)==null?void 0:H._special)==="select_provider_stt"?(a(),_(nt,{key:1,"model-value":l.modelValue,"onUpdate:modelValue":s,"provider-type":"speech_to_text"},null,8,["model-value"])):((j=l.itemMeta)==null?void 0:j._special)==="select_provider_tts"?(a(),_(nt,{key:2,"model-value":l.modelValue,"onUpdate:modelValue":s,"provider-type":"text_to_speech"},null,8,["model-value"])):x((C=l.itemMeta)==null?void 0:C._special)==="select_agent_runner_provider"?(a(),_(nt,{key:3,"model-value":l.modelValue,"onUpdate:modelValue":s,"provider-type":"agent_runner","provider-subtype":G((S=l.itemMeta)==null?void 0:S._special)},null,8,["model-value","provider-subtype"])):((E=l.itemMeta)==null?void 0:E._special)==="provider_pool"?(a(),_(nt,{key:4,"model-value":l.modelValue,"onUpdate:modelValue":s,"provider-type":"chat_completion","button-text":"é€‰æ‹©æä¾›å•†æ± ..."},null,8,["model-value"])):((L=l.itemMeta)==null?void 0:L._special)==="select_persona"?(a(),_(Et,{key:5,"model-value":l.modelValue,"onUpdate:modelValue":s},null,8,["model-value"])):((I=l.itemMeta)==null?void 0:I._special)==="persona_pool"?(a(),_(Et,{key:6,"model-value":l.modelValue,"onUpdate:modelValue":s,"button-text":"é€‰æ‹©äººæ ¼æ± ..."},null,8,["model-value"])):((U=l.itemMeta)==null?void 0:U._special)==="select_knowledgebase"?(a(),_(go,{key:7,"model-value":l.modelValue,"onUpdate:modelValue":s},null,8,["model-value"])):((v=l.itemMeta)==null?void 0:v._special)==="select_plugin_set"?(a(),_($o,{key:8,"model-value":l.modelValue,"onUpdate:modelValue":s},null,8,["model-value"])):((K=l.itemMeta)==null?void 0:K._special)==="t2i_template"?(a(),_(Ko,{key:9})):((r=l.itemMeta)==null?void 0:r._special)==="get_embedding_dim"?(a(),f("div",No,[t(_e,{"model-value":l.modelValue,"onUpdate:modelValue":s,density:"compact",variant:"outlined",class:"config-field",type:"number","hide-details":""},null,8,["model-value"]),t(T,{color:"primary",variant:"tonal",size:"small",onClick:N[0]||(N[0]=Se=>A.$emit("get-embedding-dim")),loading:l.loading,class:"ml-2"},{default:e(()=>[o(" è‡ªåŠ¨æ£€æµ‹ ")]),_:1},8,["loading"])])):((b=l.itemMeta)==null?void 0:b.type)==="list"&&((d=l.itemMeta)!=null&&d.options)&&((w=l.itemMeta)==null?void 0:w.render_type)==="checkbox"?(a(),f("div",Fo,[(a(!0),f(Q,null,ve(l.itemMeta.options,(Se,Ce)=>(a(),_(Ft,{key:Ce,"model-value":l.modelValue,"onUpdate:modelValue":s,label:k(l.itemMeta,Ce,Se),value:Se,class:"mr-2",color:"primary","hide-details":""},null,8,["model-value","label","value"]))),128))])):((D=l.itemMeta)==null?void 0:D.type)==="list"&&((ge=l.itemMeta)!=null&&ge.options)?(a(),_(rl,{key:12,"model-value":l.modelValue,"onUpdate:modelValue":s,items:l.itemMeta.options,disabled:(Te=l.itemMeta)==null?void 0:Te.readonly,density:"compact",variant:"outlined",class:"config-field","hide-details":"",chips:"",multiple:""},null,8,["model-value","items","disabled"])):(de=l.itemMeta)!=null&&de.options?(a(),_(Ct,{key:13,"model-value":l.modelValue,"onUpdate:modelValue":s,items:m(l.itemMeta),disabled:(re=l.itemMeta)==null?void 0:re.readonly,density:"compact",variant:"outlined",class:"config-field","hide-details":""},null,8,["model-value","items","disabled"])):(ye=l.itemMeta)!=null&&ye.editor_mode?(a(),f("div",Mo,[t(u(St),{theme:((W=l.itemMeta)==null?void 0:W.editor_theme)||"vs-light",language:((Z=l.itemMeta)==null?void 0:Z.editor_language)||"json",style:{"min-height":"100px","flex-grow":"1",border:"1px solid rgba(0, 0, 0, 0.1)"},value:l.modelValue,"onUpdate:value":s},null,8,["theme","language","value"]),l.showFullscreenBtn?(a(),_(T,{key:0,icon:"",size:"small",variant:"text",color:"primary",class:"editor-fullscreen-btn",onClick:N[1]||(N[1]=Se=>A.$emit("open-fullscreen")),title:u(n)("core.common.editor.fullscreen")},{default:e(()=>[t(Y,null,{default:e(()=>[o("mdi-fullscreen")]),_:1})]),_:1},8,["title"])):O("",!0)])):((ae=l.itemMeta)==null?void 0:ae.type)==="string"?(a(),_(_e,{key:15,"model-value":l.modelValue,"onUpdate:modelValue":s,density:"compact",variant:"outlined",class:"config-field","hide-details":""},null,8,["model-value"])):((je=l.itemMeta)==null?void 0:je.type)==="int"||((He=l.itemMeta)==null?void 0:He.type)==="float"?(a(),f("div",Jo,[(Qe=l.itemMeta)!=null&&Qe.slider?(a(),_(xt,{key:0,"model-value":y(l.modelValue),"onUpdate:modelValue":N[2]||(N[2]=Se=>s(y(Se))),min:((We=(Je=l.itemMeta)==null?void 0:Je.slider)==null?void 0:We.min)??0,max:((Re=(ze=l.itemMeta)==null?void 0:ze.slider)==null?void 0:Re.max)??100,step:((Ge=(Be=l.itemMeta)==null?void 0:Be.slider)==null?void 0:Ge.step)??1,color:"primary",density:"compact","hide-details":"",class:"flex-grow-1"},null,8,["model-value","min","max","step"])):O("",!0),t(_e,{"model-value":l.modelValue,"onUpdate:modelValue":N[3]||(N[3]=Se=>s(y(Se))),density:"compact",variant:"outlined",class:"config-field",type:"number","hide-details":"",style:{"max-width":"140px"}},null,8,["model-value"])])):((Oe=l.itemMeta)==null?void 0:Oe.type)==="text"?(a(),_(Dt,{key:17,"model-value":l.modelValue,"onUpdate:modelValue":s,variant:"outlined",rows:"3",class:"config-field","hide-details":""},null,8,["model-value"])):((Ke=l.itemMeta)==null?void 0:Ke.type)==="bool"?(a(),_(st,{key:18,"model-value":l.modelValue,"onUpdate:modelValue":s,color:"primary",inset:"",density:"compact","hide-details":""},null,8,["model-value"])):((we=l.itemMeta)==null?void 0:we.type)==="list"?(a(),_(Cl,{key:19,"model-value":l.modelValue,"onUpdate:modelValue":s,class:"config-field"},null,8,["model-value"])):((Ne=l.itemMeta)==null?void 0:Ne.type)==="dict"?(a(),_(Fl,{key:20,"model-value":l.modelValue,"item-meta":l.itemMeta,"onUpdate:modelValue":s,class:"config-field"},null,8,["model-value","item-meta"])):(a(),_(_e,{key:21,"model-value":l.modelValue,"onUpdate:modelValue":s,density:"compact",variant:"outlined",class:"config-field","hide-details":""},null,8,["model-value"]))])}}},mt=Ue(Ro,[["__scopeId","data-v-fca6ccc1"]]);const qo={class:"template-list-editor"},Ho={class:"top-bar d-flex align-center justify-end mb-3"},Wo={class:"d-flex align-center ga-2"},Go={class:"d-flex flex-column"},Yo={class:"d-flex align-center ga-1"},Zo={key:0,class:"px-4 py-2"},Qo={key:1,class:"template-entry-body"},Xo={key:0,class:"nested-container mx-4"},ei={class:"config-section mb-2"},ti={key:0},li={class:"property-key"},ai={key:1},oi={__name:"TemplateListEditor",props:{modelValue:{type:Array,default:()=>[]},templates:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(l,{emit:h}){const n=l,{t:g}=tt(),s=V({}),y=(I,U)=>I&&typeof I=="string"?I:U,k=ie(()=>y(g("core.common.templateList.addEntry"),"æ·»åŠ æ¡ç›®")),p=ie(()=>y(g("core.common.templateList.empty"),"æš‚æ— æ¡ç›®ï¼Œè¯·å…ˆé€‰æ‹©æ¨¡æ¿å¹¶æ·»åŠ ã€‚")),m={int:0,float:0,bool:!1,string:"",text:"",list:[],object:{},template_list:[]},q=ie(()=>Object.entries(n.templates||{}).map(([I,U])=>({label:(U==null?void 0:U.name)||I,value:I,hint:(U==null?void 0:U.hint)||(U==null?void 0:U.description)||""})));function x(I){var U,v;return I?((v=(U=n.templates)==null?void 0:U[I])==null?void 0:v.name)||I:g("core.common.templateList.unknownTemplate")||"æœªæŒ‡å®šæ¨¡æ¿"}function G(I={}){const U={};for(const[v,K]of Object.entries(I)){if(!K||!K.type)continue;const r=Object.prototype.hasOwnProperty.call(K,"default")?K.default:m[K.type];K.type==="object"?U[v]=G(K.items||{}):U[v]=r}return U}function A(I,U={}){let v=!1;for(const[K,r]of Object.entries(U)){if(!r||!r.type)continue;const d=Object.prototype.hasOwnProperty.call(r,"default")?r.default:m[r.type];r.type==="object"?!I[K]||typeof I[K]!="object"?(I[K]=G(r.items||{}),v=!0):A(I[K],r.items||{})&&(v=!0):K in I||(I[K]=d,v=!0)}return v}function N(){if(!Array.isArray(n.modelValue))return;let I=!1;const U=n.modelValue.map((v,K)=>{const r=C(v);if(!r||!r.items)return v;const b=JSON.parse(JSON.stringify(v));let d=A(b,r.items);return Object.prototype.hasOwnProperty.call(b,"__template_key")||(b.__template_key="",d=!0),K in s.value||(s.value[K]=!1),d&&(I=!0),b});I&&h("update:modelValue",U)}Ae(()=>n.modelValue,()=>N(),{immediate:!0,deep:!0});function B(I){var K;if(!I)return;const U=(K=n.templates)==null?void 0:K[I];if(!U)return;const v={__template_key:I,...G(U.items||{})};h("update:modelValue",[...n.modelValue||[],v]),s.value[n.modelValue.length]=!0}function H(I){const U=[...n.modelValue||[]];U.splice(I,1);const v={};U.forEach((K,r)=>{const b=r>=I?r+1:r;v[r]=s.value[b]??!1}),s.value=v,h("update:modelValue",U)}function j(I){s.value[I]=!s.value[I]}function C(I){var v;if(!I)return null;const U=I.__template_key;return U&&((v=n.templates)==null?void 0:v[U])||null}function S(I,U){const v=U.split(".");let K=I;for(const r of v)if(K&&typeof K=="object"&&r in K)K=K[r];else return;return K}function E(I,U){if(!(I!=null&&I.condition))return!0;for(const[v,K]of Object.entries(I.condition))if(S(U,v)!==K)return!1;return!0}function L(I,U,v){for(let K=U+1;K<I.length;K++){const[r,b]=I[K];if(!(b!=null&&b.invisible)&&E(b,v))return!0}return!1}return(I,U)=>(a(),f("div",qo,[$("div",Ho,[t(Lt,{transition:"fade-transition"},{activator:e(({props:v})=>[t(T,Ze({color:"primary",variant:"tonal",size:"small"},v,{"prepend-icon":"mdi-plus"}),{default:e(()=>[o(i(k.value),1)]),_:2},1040)]),default:e(()=>[t(qe,{density:"compact"},{default:e(()=>[(a(!0),f(Q,null,ve(q.value,v=>(a(),_($e,{key:v.value,onClick:K=>B(v.value)},{default:e(()=>[t(he,null,{default:e(()=>[o(i(v.label),1)]),_:2},1024),v.hint?(a(),_(xe,{key:0},{default:e(()=>[o(i(v.hint),1)]),_:2},1024)):O("",!0)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),!l.modelValue||l.modelValue.length===0?(a(),_(ct,{key:0,type:"info",variant:"tonal",density:"compact",class:"mb-3"},{default:e(()=>[o(i(p.value),1)]),_:1})):O("",!0),(a(!0),f(Q,null,ve(l.modelValue,(v,K)=>(a(),_(me,{key:K,variant:"outlined",class:"mb-3"},{default:e(()=>[t(Pe,{class:"d-flex align-center justify-space-between entry-header",onClick:r=>j(K)},{default:e(()=>{var r,b;return[$("div",Wo,[t(T,{icon:"",size:"small",variant:"text",title:s.value[K]?u(g)("core.common.collapse")||"æ”¶èµ·":u(g)("core.common.expand")||"å±•å¼€"},{default:e(()=>[t(Y,null,{default:e(()=>[o(i(s.value[K]?"mdi-chevron-down":"mdi-chevron-right"),1)]),_:2},1024)]),_:2},1032,["title"]),$("div",Go,[t(he,{class:"property-name"},{default:e(()=>[o(i(x(v.__template_key)),1)]),_:2},1024),(r=C(v))!=null&&r.hint||(b=C(v))!=null&&b.description?(a(),_(xe,{key:0,class:"property-hint"},{default:e(()=>{var d,w;return[o(i(((d=C(v))==null?void 0:d.hint)||((w=C(v))==null?void 0:w.description)),1)]}),_:2},1024)):O("",!0)])]),$("div",Yo,[t(T,{icon:"",size:"small",variant:"text",color:"error",onClick:Fe(d=>H(K),["stop"])},{default:e(()=>[t(Y,null,{default:e(()=>[o("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])]}),_:2},1032,["onClick"]),t(Mt,null,{default:e(()=>[ul(t(ce,{class:"px-0 py-1"},{default:e(()=>[C(v)?(a(),f("div",Qo,[(a(!0),f(Q,null,ve(C(v).items,(r,b,d)=>(a(),f(Q,{key:b},[(r==null?void 0:r.type)==="object"&&!(r!=null&&r.invisible)&&E(r,v)?(a(),f("div",Xo,[$("div",ei,[t(he,{class:"config-title"},{default:e(()=>[o(i((r==null?void 0:r.description)||b),1)]),_:2},1024),r!=null&&r.hint?(a(),_(xe,{key:0,class:"config-hint"},{default:e(()=>[o(i(r.hint),1)]),_:2},1024)):O("",!0)]),(a(!0),f(Q,null,ve(r.items,(w,D,ge)=>(a(),f("div",{key:D},[!(w!=null&&w.invisible)&&E(w,v)?(a(),f(Q,{key:0},[t(Ee,{class:"config-row"},{default:e(()=>[t(ue,{cols:"12",sm:"6",class:"property-info"},{default:e(()=>[t($e,{density:"compact"},{default:e(()=>[t(he,{class:"property-name"},{default:e(()=>[o(i((w==null?void 0:w.description)||D),1)]),_:2},1024),t(xe,{class:"property-hint"},{default:e(()=>[o(i(w==null?void 0:w.hint),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(ue,{cols:"12",sm:"6",class:"config-input"},{default:e(()=>[t(mt,{modelValue:v[b][D],"onUpdate:modelValue":Te=>v[b][D]=Te,"item-meta":w},null,8,["modelValue","onUpdate:modelValue","item-meta"])]),_:2},1024)]),_:2},1024),L(Object.entries(r.items),ge,v)?(a(),_(Me,{key:0,class:"config-divider"})):O("",!0)],64)):O("",!0)]))),128))])):!(r!=null&&r.invisible)&&E(r,v)?(a(),f(Q,{key:1},[t(Ee,{class:"config-row"},{default:e(()=>[t(ue,{cols:"12",sm:"6",class:"property-info"},{default:e(()=>[t($e,{density:"compact"},{default:e(()=>[t(he,{class:"property-name"},{default:e(()=>[r!=null&&r.description?(a(),f("span",ti,[o(i(r==null?void 0:r.description)+" ",1),$("span",li,"("+i(b)+")",1)])):(a(),f("span",ai,i(b),1))]),_:2},1024),t(xe,{class:"property-hint"},{default:e(()=>[o(i(r==null?void 0:r.hint),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(ue,{cols:"12",sm:"6",class:"config-input"},{default:e(()=>[t(mt,{modelValue:v[b],"onUpdate:modelValue":w=>v[b]=w,"item-meta":r},null,8,["modelValue","onUpdate:modelValue","item-meta"])]),_:2},1024)]),_:2},1024),L(Object.entries(C(v).items),d,v)?(a(),_(Me,{key:0,class:"config-divider"})):O("",!0)],64)):O("",!0)],64))),128))])):(a(),f("div",Zo,[t(ct,{type:"error",variant:"tonal",density:"compact"},{default:e(()=>[o(i(u(g)("core.common.templateList.missingTemplate")||"æ‰¾ä¸åˆ°å¯¹åº”æ¨¡æ¿ï¼Œè¯·åˆ é™¤åé‡æ–°æ·»åŠ ã€‚"),1)]),_:1})]))]),_:2},1536),[[cl,s.value[K]]])]),_:2},1024)]),_:2},1024))),128))]))}},zt=Ue(oi,[["__scopeId","data-v-1e0976f6"]]);function Ot(){const l=ml(),h=(n,g="info",s={})=>l.add({message:n,color:g,...s});return{toast:h,success:(n,g)=>h(n,"success",g),error:(n,g)=>h(n,"error",g),info:(n,g)=>h(n,"primary",g),warning:(n,g)=>h(n,"warning",g)}}const ii={key:0,class:"config-section"},ni={class:"metadata-key"},si={key:0,class:"important-hint"},di={key:0,class:"object-config"},ri={key:0,class:"nested-object"},ui={key:0,class:"nested-container"},ci={key:1,class:"nested-object w-100"},mi={key:0,class:"nested-container"},vi={class:"config-section mb-2"},fi={key:0},pi={class:"property-key"},gi={key:1},yi={key:0,class:"important-hint"},hi={key:0},bi={class:"property-key"},_i={key:1},xi={key:0,class:"important-hint"},ki={key:1,class:"simple-config"},Vi={class:"property-key"},wi={key:0,class:"important-hint"},Si={__name:"AstrBotConfig",props:{metadata:{type:Object,required:!0},iterable:{type:Object,required:!0},metadataKey:{type:String,required:!0},isEditing:{type:Boolean,default:!1}},setup(l){const h=l,{t:n}=tt(),g=ie(()=>{if(!h.iterable)return{};const{hint:j,...C}=h.iterable;return C}),s=V(!1),y=V(""),k=V("json"),p=V("vs-light");let m=null;const q=V(!1);function x(j,C,S,E){y.value=j,k.value=E||"json",p.value=S||"vs-light",m=C,s.value=!0}function G(){s.value=!1}async function A(j){var C;if(!q.value){q.value=!0;try{const S=await se.post("/api/config/provider/get_embedding_dim",{provider_config:j});S.data.status!="error"&&((C=S.data.data)!=null&&C.embedding_dimensions)?(console.log(S.data.data.embedding_dimensions),j.embedding_dimensions=S.data.data.embedding_dimensions,Ot().success("è·å–æˆåŠŸ: "+S.data.data.embedding_dimensions)):Ot().error(S.data.message)}catch(S){console.error("Error getting embedding dimensions:",S)}finally{q.value=!1}}}function N(j,C){const S=C.split(".");let E=j;for(const L of S)if(E&&typeof E=="object"&&L in E)E=E[L];else return;return E}function B(j,C){if(!(j!=null&&j.condition))return!0;for(const[S,E]of Object.entries(j.condition))if(N(h.iterable,S)!==E)return!1;return!0}function H(j,C){const S=Object.entries(j);for(let E=C+1;E<S.length;E++){const[L,I]=S[E],U=h.metadata[h.metadataKey].items[L];if(!(U!=null&&U.invisible)&&B(U))return!0}return!1}return(j,C)=>{var E;const S=vl("AstrBotConfig",!0);return a(),f(Q,null,[l.iterable&&((E=l.metadata[l.metadataKey])==null?void 0:E.type)==="object"?(a(),f("div",ii,[t(he,{class:"config-title"},{default:e(()=>{var L;return[o(i((L=l.metadata[l.metadataKey])==null?void 0:L.description)+" ",1),$("span",ni,"("+i(l.metadataKey)+")",1)]}),_:1}),t(xe,{class:"config-hint"},{default:e(()=>{var L,I,U;return[(L=l.metadata[l.metadataKey])!=null&&L.obvious_hint&&((I=l.metadata[l.metadataKey])!=null&&I.hint)?(a(),f("span",si,"â€¼ï¸")):O("",!0),o(" "+i((U=l.metadata[l.metadataKey])==null?void 0:U.hint),1)]}),_:1})])):O("",!0),t(ce,{class:"px-0 py-1"},{default:e(()=>{var L,I;return[((L=l.metadata[l.metadataKey])==null?void 0:L.type)==="object"||(I=l.metadata[l.metadataKey])!=null&&I.config_template?(a(),f("div",di,[l.iterable.hint&&!l.isEditing?(a(),_(ct,{key:0,type:"info",variant:"tonal",class:"mb-4",border:"start",density:"compact"},{default:e(()=>[o(i(l.iterable.hint),1)]),_:1})):O("",!0),(a(!0),f(Q,null,ve(g.value,(U,v,K)=>{var r,b,d,w,D,ge,Te;return a(),f("div",{key:v,class:"config-item"},[((r=l.metadata[l.metadataKey].items[v])==null?void 0:r.type)==="object"?(a(),f("div",ri,[l.metadata[l.metadataKey].items[v]&&!((b=l.metadata[l.metadataKey].items[v])!=null&&b.invisible)&&B(l.metadata[l.metadataKey].items[v],v)?(a(),f("div",ui,[t(Mt,null,{default:e(()=>[t(S,{metadata:l.metadata[l.metadataKey].items,iterable:l.iterable[v],metadataKey:v},null,8,["metadata","iterable","metadataKey"])]),_:2},1024)])):O("",!0)])):((d=l.metadata[l.metadataKey].items[v])==null?void 0:d.type)==="template_list"?(a(),f("div",ci,[!((w=l.metadata[l.metadataKey].items[v])!=null&&w.invisible)&&B(l.metadata[l.metadataKey].items[v],v)?(a(),f("div",mi,[$("div",vi,[t(he,{class:"config-title"},{default:e(()=>{var de,re;return[(de=l.metadata[l.metadataKey].items[v])!=null&&de.description?(a(),f("span",fi,[o(i((re=l.metadata[l.metadataKey].items[v])==null?void 0:re.description)+" ",1),$("span",pi,"("+i(v)+")",1)])):(a(),f("span",gi,i(v),1))]}),_:2},1024),t(xe,{class:"config-hint"},{default:e(()=>{var de,re,ye;return[(de=l.metadata[l.metadataKey].items[v])!=null&&de.obvious_hint&&((re=l.metadata[l.metadataKey].items[v])!=null&&re.hint)?(a(),f("span",yi,"â€¼ï¸")):O("",!0),o(" "+i((ye=l.metadata[l.metadataKey].items[v])==null?void 0:ye.hint),1)]}),_:2},1024)]),t(zt,{modelValue:l.iterable[v],"onUpdate:modelValue":de=>l.iterable[v]=de,templates:((D=l.metadata[l.metadataKey].items[v])==null?void 0:D.templates)||{},class:"config-field"},null,8,["modelValue","onUpdate:modelValue","templates"])])):O("",!0)])):(a(),f(Q,{key:2},[!((ge=l.metadata[l.metadataKey].items[v])!=null&&ge.invisible)&&B(l.metadata[l.metadataKey].items[v],v)?(a(),_(Ee,{key:0,class:"config-row"},{default:e(()=>[t(ue,{cols:"12",sm:"6",class:"property-info"},{default:e(()=>[t($e,{density:"compact"},{default:e(()=>[t(he,{class:"property-name"},{default:e(()=>{var de,re;return[(de=l.metadata[l.metadataKey].items[v])!=null&&de.description?(a(),f("span",hi,[o(i((re=l.metadata[l.metadataKey].items[v])==null?void 0:re.description)+" ",1),$("span",bi,"("+i(v)+")",1)])):(a(),f("span",_i,i(v),1))]}),_:2},1024),t(xe,{class:"property-hint"},{default:e(()=>{var de,re,ye;return[(de=l.metadata[l.metadataKey].items[v])!=null&&de.obvious_hint&&((re=l.metadata[l.metadataKey].items[v])!=null&&re.hint)?(a(),f("span",xi,"â€¼ï¸")):O("",!0),o(" "+i((ye=l.metadata[l.metadataKey].items[v])==null?void 0:ye.hint),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024),t(ue,{cols:"12",sm:"6",class:"config-input"},{default:e(()=>{var de;return[t(mt,{modelValue:l.iterable[v],"onUpdate:modelValue":re=>l.iterable[v]=re,"item-meta":l.metadata[l.metadataKey].items[v]||null,loading:q.value,"show-fullscreen-btn":!!((de=l.metadata[l.metadataKey].items[v])!=null&&de.editor_mode),onGetEmbeddingDim:C[0]||(C[0]=re=>A(l.iterable)),onOpenFullscreen:re=>{var ye,W;return x(v,l.iterable,(ye=l.metadata[l.metadataKey].items[v])==null?void 0:ye.editor_theme,(W=l.metadata[l.metadataKey].items[v])==null?void 0:W.editor_language)}},null,8,["modelValue","onUpdate:modelValue","item-meta","loading","show-fullscreen-btn","onOpenFullscreen"])]}),_:2},1024)]),_:2},1024)):O("",!0),H(g.value,K)&&!((Te=l.metadata[l.metadataKey].items[v])!=null&&Te.invisible)&&B(l.metadata[l.metadataKey].items[v],v)?(a(),_(Me,{key:1,class:"config-divider"})):O("",!0)],64))])}),128))])):(a(),f("div",ki,[t(Ee,{class:"config-row"},{default:e(()=>[t(ue,{cols:"12",sm:"7",class:"property-info"},{default:e(()=>[t($e,{density:"compact"},{default:e(()=>[t(he,{class:"property-name"},{default:e(()=>{var U;return[o(i((U=l.metadata[l.metadataKey])==null?void 0:U.description)+" ",1),$("span",Vi,"("+i(l.metadataKey)+")",1)]}),_:1}),t(xe,{class:"property-hint"},{default:e(()=>{var U,v,K;return[(U=l.metadata[l.metadataKey])!=null&&U.obvious_hint&&((v=l.metadata[l.metadataKey])!=null&&v.hint)?(a(),f("span",wi,"â€¼ï¸")):O("",!0),o(" "+i((K=l.metadata[l.metadataKey])==null?void 0:K.hint),1)]}),_:1})]),_:1})]),_:1}),t(ue,{cols:"12",sm:"5",class:"config-input"},{default:e(()=>{var U,v,K;return[((U=l.metadata[l.metadataKey])==null?void 0:U.type)==="template_list"&&!((v=l.metadata[l.metadataKey])!=null&&v.invisible)?(a(),_(zt,{key:0,modelValue:l.iterable[l.metadataKey],"onUpdate:modelValue":C[1]||(C[1]=r=>l.iterable[l.metadataKey]=r),templates:((K=l.metadata[l.metadataKey])==null?void 0:K.templates)||{},class:"config-field"},null,8,["modelValue","templates"])):(a(),_(mt,{key:1,modelValue:l.iterable[l.metadataKey],"onUpdate:modelValue":C[2]||(C[2]=r=>l.iterable[l.metadataKey]=r),"item-meta":l.metadata[l.metadataKey]},null,8,["modelValue","item-meta"]))]}),_:1})]),_:1}),t(Me,{class:"my-2 config-divider"})]))]}),_:1}),t(Ve,{modelValue:s.value,"onUpdate:modelValue":C[5]||(C[5]=L=>s.value=L),fullscreen:"",transition:"dialog-bottom-transition",scrollable:""},{default:e(()=>[t(me,null,{default:e(()=>[t(Vt,{color:"primary",dark:""},{default:e(()=>[t(T,{icon:"",onClick:C[3]||(C[3]=L=>s.value=!1)},{default:e(()=>[t(Y,null,{default:e(()=>[o("mdi-close")]),_:1})]),_:1}),t(wt,null,{default:e(()=>[o(i(u(n)("core.common.editor.editingTitle"))+" - "+i(y.value),1)]),_:1}),t(pe),t(fl,null,{default:e(()=>[t(T,{variant:"text",onClick:G},{default:e(()=>[o(i(u(n)("core.common.save")),1)]),_:1})]),_:1})]),_:1}),t(ce,{class:"pa-0"},{default:e(()=>[t(u(St),{theme:p.value,language:k.value,style:{height:"calc(100vh - 64px)"},value:u(m)[y.value],"onUpdate:value":C[4]||(C[4]=L=>u(m)[y.value]=L)},null,8,["theme","language","value"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},rt=Ue(Si,[["__scopeId","data-v-74ca34b4"]]);export{rt as A,mt as C,Hl as I,xa as P,zt as T,ka as a,ma as b,Ii as c,Ot as u};
