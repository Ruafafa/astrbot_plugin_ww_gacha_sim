import{u as ce,c as N,r as tt,o as u,a as _,w as t,b as a,V as J,m as Se,d as ae,e as d,t as i,f as e,g as z,F as ye,h as Le,n as oe,i as at,j as Te,k as ue,l as R,p as C,q as ot,s as K,v as c,x as Ie,y as ne,z as De,A as r,B as D,C as se,D as lt,E as nt,G as ie,H as _e,I as re,J as de,K as F,L as st,M as Ne,N as it,O as rt,P as dt,Q as O,R as Pe,S as We,T as Me,U as ut,W as He,X as ct,Y as mt,Z as A,_ as Fe,$ as pt,a0 as vt,a1 as Xe,a2 as gt,a3 as Re,a4 as ft,a5 as ke,a6 as ht,a7 as Ue,a8 as Be,a9 as _t,aa as yt,ab as bt,ac as wt,ad as xt}from"./index-61371d60.js";import{useCustomizerStore as H}from"./customizer-e056107a.js";import{s as he,a as Ve,M as kt}from"./MigrationDialog-eaf64b46.js";import{l as Oe,D as Ye,m as Ce}from"./github-9f73710c.js";import{_ as $e}from"./_plugin-vue_export-helper-c27b6911.js";import{m as Ae}from"./md5-0038c899.js";import{u as Vt}from"./common-619402c2.js";import{S as Dt}from"./LanguageSwitcher-43bc380c.js";import Ct from"./AboutPage-fc87cfcc.js";import{C as St}from"./Chat-eabeac92.js";import"./ConsoleDisplayer-69ceb810.js";import"./WaitingForRestart-d6ba996f.js";import"./MessageList-fbdd7c7f.js";import"./AstrBotConfig-27eff76a.js";import"./index-2a23493b.js";import"./PersonaForm-76e4f5a1.js";import"./useRecording-073e8009.js";const Lt={__name:"NavItem",props:{item:Object,level:Number},setup(m){const p=m,{t:M}=ce(),o=H(),U=N(()=>{const h=p.level??0;return{"--indent-padding":o.mini_sidebar?"0px":`${h*24}px`}});return(h,S)=>{const f=tt("NavItem",!0);return m.item.children?(u(),_(at,{key:0,value:m.item.title,class:oe({"group-bordered":e(o).mini_sidebar})},{activator:t(({props:w})=>[a(J,Se(w,{rounded:"",class:"mb-1",color:"secondary","prepend-icon":m.item.icon,style:{"--indent-padding":"0px"}}),{default:t(()=>[a(ae,{style:{"font-size":"14px","font-weight":"500","line-height":"1.2","word-break":"break-word"}},{default:t(()=>[d(i(e(M)(m.item.title)),1)]),_:1})]),_:2},1040,["prepend-icon"])]),default:t(()=>[(u(!0),z(ye,null,Le(m.item.children,(w,k)=>(u(),_(f,{key:k,item:w,level:(m.level||0)+1},null,8,["item","level"]))),128))]),_:1},8,["value","class"])):(u(),_(J,{key:1,to:m.item.type==="external"?"":m.item.to,href:m.item.type==="external"?m.item.to:"",rounded:"",class:"mb-1",color:"secondary",disabled:m.item.disabled,target:m.item.type==="external"?"_blank":"",style:K(U.value)},Te({prepend:t(()=>[m.item.icon?(u(),_(R,{key:0,size:m.item.iconSize,class:"hide-menu",icon:m.item.icon},null,8,["size","icon"])):C("",!0)]),default:t(()=>[a(ae,{style:{"font-size":"14px"}},{default:t(()=>[d(i(e(M)(m.item.title)),1)]),_:1}),m.item.subCaption?(u(),_(ot,{key:0,class:"text-caption mt-n1 hide-menu"},{default:t(()=>[d(i(m.item.subCaption),1)]),_:1})):C("",!0)]),_:2},[m.item.chip?{name:"append",fn:t(()=>[a(ue,{color:m.item.chipColor,class:"sidebarchip hide-menu",size:m.item.chipIcon?"small":"default",variant:m.item.chipVariant,"prepend-icon":m.item.chipIcon},{default:t(()=>[d(i(m.item.chip),1)]),_:1},8,["color","size","variant","prepend-icon"])]),key:"0"}:void 0]),1032,["to","href","disabled","target","style"]))}}};const Tt={class:"text-h3"},It={class:"mb-4"},Mt={style:{"max-height":"70vh","overflow-y":"auto"}},$t={key:0,class:"text-center py-8"},zt={class:"mt-4"},Et={key:2,class:"changelog-content"},Rt={__name:"ChangelogDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(m,{emit:p}){const M=m;Oe(),Ye();const{t:o}=ce(),U=N({get:()=>M.modelValue,set:V=>p("update:modelValue",V)}),h=c(""),S=c(!1),f=c(""),w=c(""),k=c(""),y=c([]),T=c(!1);async function B(){var V;try{const b=((V=(await F.get("/api/stat/version")).data.data)==null?void 0:V.version)||"";return w.value=b,k.value=b,b}catch(x){return console.error("Failed to get version:",x),""}}async function E(V){var b,P,X,q;const x=V||k.value||w.value;if(!x){f.value=o("core.navigation.changelogDialog.selectVersion");return}S.value=!0,f.value="",h.value="";try{const I=await F.get("/api/stat/changelog",{params:{version:x}});I.data.status==="ok"?(h.value=I.data.data.content,k.value=x):f.value=I.data.message||o("core.navigation.changelogDialog.error")}catch(I){console.error("Failed to load changelog:",I),((b=I.response)==null?void 0:b.status)===404||(q=(X=(P=I.response)==null?void 0:P.data)==null?void 0:X.message)!=null&&q.includes("not found")?f.value=o("core.navigation.changelogDialog.notFound"):f.value=o("core.navigation.changelogDialog.error")}finally{S.value=!1}}async function Y(){T.value=!0;try{const V=await F.get("/api/stat/changelog/list");V.data.status==="ok"&&(y.value=V.data.data.versions||[])}catch(V){console.error("Failed to load versions:",V)}finally{T.value=!1}}function j(){k.value&&E(k.value)}return Ie(U,async V=>{V?(await Y(),w.value||await B(),w.value&&y.value.includes(w.value)?(k.value=w.value,await E()):y.value.length>0&&(k.value=y.value[0],await E(y.value[0]))):(h.value="",f.value="")}),B(),(V,x)=>(u(),_(de,{"model-value":U.value,"onUpdate:modelValue":x[3]||(x[3]=b=>U.value=b),width:V.$vuetify.display.smAndDown?"100%":"800",fullscreen:V.$vuetify.display.xs,"max-width":"1000"},{default:t(()=>[a(ne,null,{default:t(()=>[a(De,{class:"d-flex justify-space-between align-center"},{default:t(()=>[r("span",Tt,i(e(o)("core.navigation.changelogDialog.title")),1),a(D,{icon:"",onClick:x[0]||(x[0]=b=>U.value=!1),flat:""},{default:t(()=>[a(R,null,{default:t(()=>[d("mdi-close")]),_:1})]),_:1})]),_:1}),a(se,null,{default:t(()=>[r("div",It,[a(lt,{modelValue:k.value,"onUpdate:modelValue":[x[1]||(x[1]=b=>k.value=b),j],items:y.value,label:e(o)("core.navigation.changelogDialog.selectVersion"),loading:T.value,variant:"outlined",density:"compact"},{item:t(({item:b,props:P})=>[a(J,Se(P,{title:`v${b.value}`}),Te({_:2},[b.value===w.value?{name:"append",fn:t(()=>[a(ue,{size:"x-small",color:"primary",variant:"tonal"},{default:t(()=>[d(i(e(o)("core.navigation.changelogDialog.current")),1)]),_:1})]),key:"0"}:void 0]),1040,["title"])]),selection:t(({item:b})=>[r("span",null,"v"+i(b.value),1)]),_:1},8,["modelValue","items","label","loading"])]),r("div",Mt,[S.value?(u(),z("div",$t,[a(nt,{indeterminate:"",color:"primary"}),r("div",zt,i(e(o)("core.navigation.changelogDialog.loading")),1)])):f.value?(u(),_(ie,{key:1,type:"error",variant:"tonal",border:"start"},{default:t(()=>[d(i(f.value),1)]),_:1})):h.value?(u(),z("div",Et,[a(e(Ce),{content:h.value,typewriter:!1,class:"markdown-content"},null,8,["content"])])):C("",!0)])]),_:1}),a(_e,null,{default:t(()=>[a(re),a(D,{color:"blue-darken-1",variant:"text",onClick:x[2]||(x[2]=b=>U.value=!1)},{default:t(()=>[d(i(e(o)("core.common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value","width","fullscreen"]))}};const Ut=m=>(Pe("data-v-3c479209"),m=m(),We(),m),Bt={class:"sidebar-container"},At={key:0,class:"sidebar-footer"},Nt={style:{display:"flex","align-items":"center"}},Pt={style:{"margin-left":"8px"}},Wt={style:{display:"flex",gap:"8px"}},Ht=Ut(()=>r("iframe",{src:"https://astrbot.app",style:{width:"100%",height:"calc(100% - 56px)",border:"none","border-bottom-left-radius":"12px","border-bottom-right-radius":"12px"}},null,-1)),Ft=200,Xt=300,Ot={__name:"VerticalSidebar",setup(m){const{t:p}=ce(),M=H(),o=st(he),U=c(JSON.parse(localStorage.getItem("sidebar_openedItems")||"[]"));Ie(U,g=>localStorage.setItem("sidebar_openedItems",JSON.stringify(g)),{deep:!0});const h=g=>{g.key==="astrbot_sidebar_customization"&&(o.value=Ve(he))},S=()=>{o.value=Ve(he)};Ne(()=>{o.value=Ve(he),window.addEventListener("storage",h),window.addEventListener("sidebar-customization-changed",S)}),it(()=>{window.removeEventListener("storage",h),window.removeEventListener("sidebar-customization-changed",S)});const f=c(!1),w=c(null),k=c(!1),y=c(235),T=c(!1),B=c({position:"fixed",bottom:"16px",right:"16px",width:"490px",height:"640px",minWidth:"300px",minHeight:"200px",background:"white",resize:"both",overflow:"auto",zIndex:"10000000",borderRadius:"12px",boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.1)"});window.innerWidth<768&&(B.value={position:"fixed",top:"10%",left:"0%",width:"100%",height:"80%",minWidth:"300px",minHeight:"200px",background:"white",resize:"both",overflow:"auto",zIndex:"1002",borderRadius:"12px",boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.1)"},M.Sidebar_drawer=!1);const E={width:"100%",padding:"8px",background:"#f0f0f0",borderBottom:"1px solid #ccc",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move"};function Y(){f.value=!f.value}function j(g){if(typeof window<"u"){let v=g||"https://astrbot.app";window.open(v,"_blank")}}let V=0,x=0,b=!1;function P(g,v,L){return Math.min(Math.max(g,v),L)}function X(g,v){b=!0;const W=document.getElementById("draggable-iframe").getBoundingClientRect();V=g-W.left,x=v-W.top,document.body.style.userSelect="none",document.addEventListener("mousemove",I),document.addEventListener("mouseup",le),document.addEventListener("touchmove",pe,{passive:!1}),document.addEventListener("touchend",Q)}function q(g){X(g.clientX,g.clientY)}function I(g){b&&ve(g.clientX,g.clientY)}function le(){ge()}function me(g){if(g.touches.length===1){const v=g.touches[0];X(v.clientX,v.clientY)}}function pe(g){if(b&&g.touches.length===1){g.preventDefault();const v=g.touches[0];ve(v.clientX,v.clientY)}}function Q(){ge()}function ve(g,v){const L=document.getElementById("draggable-iframe"),W=P(g-V,0,window.innerWidth-L.offsetWidth),te=P(v-x,0,window.innerHeight-L.offsetHeight);B.value.left=W+"px",B.value.top=te+"px"}function ge(){b=!1,document.body.style.userSelect="",document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",le),document.removeEventListener("touchmove",pe),document.removeEventListener("touchend",Q)}function Z(g){T.value=!0,document.body.style.userSelect="none",document.body.style.cursor="ew-resize";const v=g.clientX,L=y.value;function W(be){if(!T.value)return;const we=be.clientX-v,xe=Math.max(Ft,Math.min(Xt,L+we));y.value=xe}function te(){T.value=!1,document.body.style.userSelect="",document.body.style.cursor="",document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",te)}document.addEventListener("mousemove",W),document.addEventListener("mouseup",te)}function ee(g){return g.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}async function $(){try{const v=await(await fetch("https://cloud.astrbot.app/api/v1/github/repo-info")).json();v.data&&v.data.stargazers_count&&(w.value=v.data.stargazers_count,console.debug("Fetched star count:",w.value))}catch(g){console.debug("Failed to fetch star count:",g)}}$();function fe(){k.value=!0}return(g,v)=>(u(),z(ye,null,[a(dt,{left:"",modelValue:e(M).Sidebar_drawer,"onUpdate:modelValue":v[2]||(v[2]=L=>e(M).Sidebar_drawer=L),elevation:"0","rail-width":"80",app:"",class:"leftSidebar",width:y.value,rail:e(M).mini_sidebar},{default:t(()=>[r("div",Bt,[a(rt,{class:"pa-4 listitem flex-grow-1",opened:U.value,"onUpdate:opened":v[0]||(v[0]=L=>U.value=L),"open-strategy":"multiple"},{default:t(()=>[(u(!0),z(ye,null,Le(o.value,(L,W)=>(u(),_(Lt,{key:W,item:L,class:"leftPadding"},null,8,["item"]))),128))]),_:1},8,["opened"]),e(M).mini_sidebar?C("",!0):(u(),z("div",At,[a(D,{style:{"margin-bottom":"8px"},size:"small",variant:"tonal",color:"primary",to:"/settings"},{default:t(()=>[d(" ðŸ”§ "+i(e(p)("core.navigation.settings")),1)]),_:1}),a(D,{style:{"margin-bottom":"8px"},size:"small",variant:"plain",onClick:fe},{default:t(()=>[d(" ðŸ“ "+i(e(p)("core.navigation.changelog")),1)]),_:1}),a(D,{style:{"margin-bottom":"8px"},size:"small",variant:"plain",onClick:Y},{default:t(()=>[d(i(e(p)("core.navigation.documentation")),1)]),_:1}),a(D,{style:{"margin-bottom":"8px"},size:"small",variant:"plain",onClick:v[1]||(v[1]=L=>j("https://github.com/AstrBotDevs/AstrBot"))},{default:t(()=>[d(i(e(p)("core.navigation.github"))+" ",1),w.value?(u(),_(ue,{key:0,size:"x-small",variant:"outlined",class:"ml-2",style:{"font-weight":"normal"}},{default:t(()=>[d(i(ee(w.value)),1)]),_:1})):C("",!0)]),_:1})]))]),!e(M).mini_sidebar&&e(M).Sidebar_drawer?(u(),z("div",{key:0,class:oe(["sidebar-resize-handle",{resizing:T.value}]),onMousedown:Z},null,34)):C("",!0)]),_:1},8,["modelValue","width","rail"]),f.value?(u(),z("div",{key:0,id:"draggable-iframe",style:K(B.value)},[r("div",{style:E,onMousedown:q,onTouchstart:me},[r("div",Nt,[a(R,{icon:"mdi-cursor-move"}),r("span",Pt,i(e(p)("core.navigation.drag")),1)]),r("div",Wt,[a(D,{icon:"",onClick:v[3]||(v[3]=O(L=>j("https://astrbot.app"),["stop"])),onMousedown:v[4]||(v[4]=O(()=>{},["stop"])),style:{"border-radius":"8px",border:"1px solid #ccc"}},{default:t(()=>[a(R,{icon:"mdi-open-in-new"})]),_:1}),a(D,{icon:"",onClick:O(Y,["stop"]),onMousedown:v[5]||(v[5]=O(()=>{},["stop"])),style:{"border-radius":"8px",border:"1px solid #ccc"}},{default:t(()=>[a(R,{icon:"mdi-close"})]),_:1},8,["onClick"])])],32),Ht],4)):C("",!0),a(Rt,{modelValue:k.value,"onUpdate:modelValue":v[6]||(v[6]=L=>k.value=L)},null,8,["modelValue"])],64))}},Yt=$e(Ot,[["__scopeId","data-v-3c479209"]]),jt="/assets/xmas-hat-7e191eab.png",qt="/assets/astrbot_logo_mini-93eefda2.webp",Gt=m=>(Pe("data-v-861661f1"),m=m(),We(),m),Jt={class:"logo-container"},Kt={class:"logo-content"},Qt=Gt(()=>r("div",{class:"logo-image"},[r("img",{width:"110",src:qt,alt:"AstrBot Logo"})],-1)),Zt={class:"logo-text"},ea=["innerHTML"],ta=Me({__name:"Logo",props:{title:{default:""},subtitle:{default:""}},setup(m){const{t:p}=ce(),M=o=>o.includes("AstrBot ")||o.includes("AstrBot")?o.replace(/(AstrBot)\s+(.+)/,"$1<wbr> $2"):o;return(o,U)=>(u(),z("div",Jt,[r("div",Kt,[Qt,r("div",Zt,[r("h2",{style:K({color:e(H)().uiTheme==="PurpleTheme"?"#5e35b1":"#d7c5fa"}),innerHTML:M(o.title||e(p)("core.header.logoTitle"))},null,12,ea),r("h4",{style:K({color:e(H)().uiTheme==="PurpleTheme"?"#000000aa":"#ffffffcc"}),class:"hint-text"},i(o.subtitle||e(p)("core.header.accountDialog.title")),5)])])]))}});const aa=$e(ta,[["__scopeId","data-v-861661f1"]]),oa={class:"logo-text Outfit"},la={class:"logo-text bot-text-wrapper"},na={key:0,src:jt,alt:"Christmas hat",class:"xmas-hat"},sa={key:0,class:"logo-text logo-text-light Outfit",style:{color:"grey"}},ia={class:"version-text hidden-xs"},ra={class:"mr-4 hidden-xs"},da={key:0},ua={key:1},ca={class:"language-flag"},ma={class:"text-h5"},pa={style:{display:"inline-block"}},va={style:{"margin-left":"4px"}},ga={key:0,style:{"background-color":"#646cff24",padding:"16px","border-radius":"10px","font-size":"14px","max-height":"400px","overflow-y":"auto"}},fa={class:"mb-4 mt-4"},ha={class:"mb-4"},_a={href:"https://containrrr.dev/watchtower/usage-overview/"},ya={class:"text-body-2"},ba=r("br",null,null,-1),wa={href:"https://github.com/AstrBotDevs/AstrBot/issues",target:"_blank",class:"text-decoration-none"},xa={class:"d-flex align-center"},ka={style:{"margin-top":"16px"}},Va={class:"mb-4"},Da={class:"mb-4"},Ca=r("br",null,null,-1),Sa={class:"mb-4"},La={key:0},Ta={key:1},Ia={class:"d-flex flex-column align-center mb-6"},Ma={class:"text-caption text-medium-emphasis mt-2"},$a=Me({__name:"VerticalHeader",setup(m){Oe(),Ye();const p=H(),M=ut(),{t:o}=ce(),U=He();let h=c(!1),S=c(!1),f=c(!1),w=c(!1);const k=localStorage.getItem("user");let y=c(""),T=c(""),B=c("");c("");let E=c(""),Y=c(""),j=c(!1),V=c(""),x=c(!1),b=c("");c("");let P=c([]),X=c(!1),q=c(!1),I=c(!1),le=c(""),me=c("");const pe=N(()=>[{title:o("core.header.updateDialog.table.tag"),key:"tag_name"},{title:o("core.header.updateDialog.table.publishDate"),key:"published_at"},{title:o("core.header.updateDialog.table.content"),key:"body"},{title:o("core.header.updateDialog.table.sourceUrl"),key:"zipball_url"},{title:o("core.header.updateDialog.table.actions"),key:"switch"}]),Q=c(!0),ve=N(()=>[l=>!!l||o("core.header.accountDialog.validation.passwordRequired"),l=>l.length>=8||o("core.header.accountDialog.validation.passwordMinLength")]),ge=N(()=>[l=>!l||l.length>=3||o("core.header.accountDialog.validation.usernameMinLength")]),Z=c(!1),ee=c(!1),$=c({loading:!1,success:!1,error:!1,message:""}),fe=l=>{const n=["alpha","beta","rc","pre","preview","dev"],s=l.toLowerCase();return n.some(G=>s.includes(G))};function g(){$.value.loading=!0,$.value.error=!1,$.value.success=!1,y.value!=""&&(y.value=Ae.md5(y.value)),T.value!=""&&(T.value=Ae.md5(T.value)),F.post("/api/auth/account/edit",{password:y.value,new_password:T.value,new_username:B.value?B.value:k}).then(l=>{if(l.data.status=="error"){$.value.error=!0,$.value.message=l.data.message,y.value="",T.value="";return}$.value.success=!0,$.value.message=l.data.message,setTimeout(()=>{h.value=!h.value,Ue().logout()},2e3)}).catch(l=>{console.log(l),$.value.error=!0,$.value.message=typeof l=="string"?l:o("core.header.accountDialog.messages.updateFailed"),y.value="",T.value=""}).finally(()=>{$.value.loading=!1})}function v(){F.get("/api/stat/version").then(l=>{var s,G;V.value="v"+l.data.data.version,b.value=(s=l.data.data)==null?void 0:s.dashboard_version,((G=l.data.data)==null?void 0:G.change_pwd_hint)?(h.value=!0,S.value=!0,localStorage.setItem("change_pwd_hint","true")):localStorage.removeItem("change_pwd_hint")}).catch(l=>{console.log(l)})}function L(){E.value=o("core.header.updateDialog.status.checking"),F.get("/api/update/check").then(l=>{j.value=l.data.data.has_new_version,l.data.data.has_new_version?(Y.value=l.data.message,E.value=o("core.header.version.hasNewVersion")):E.value=l.data.message,x.value=l.data.data.dashboard_has_new_version}).catch(l=>{if(l.response&&l.response.status==401){console.log("401"),Ue().logout();return}console.log(l),E.value=l})}function W(){F.get("/api/update/releases").then(l=>{P.value=l.data.data.map(n=>(n.published_at=new Date(n.published_at).toLocaleString(),n))}).catch(l=>{console.log(l)})}function te(l){E.value=o("core.header.updateDialog.status.switching"),q.value=!0,F.post("/api/update/do",{version:l,proxy:localStorage.getItem("selectedGitHubProxy")||""}).then(n=>{E.value=n.data.message,n.data.status=="ok"&&setTimeout(()=>{window.location.reload()},1e3)}).catch(n=>{console.log(n),E.value=n}).finally(()=>{q.value=!1})}function be(){X.value=!0,E.value=o("core.header.updateDialog.status.updating"),F.post("/api/update/dashboard").then(l=>{E.value=l.data.message,l.data.status=="ok"&&setTimeout(()=>{window.location.reload()},1e3)}).catch(l=>{console.log(l),E.value=l}).finally(()=>{X.value=!1})}function we(){const l=p.uiTheme==="PurpleThemeDark"?"PurpleTheme":"PurpleThemeDark";p.SET_UI_THEME(l),M.global.name.value=l}function xe(l,n){le.value=l,me.value=n,I.value=!0}function je(){p.viewMode==="chat"?w.value=!0:Be.push("/about")}v(),L();const ze=Vt();ze.createEventSource(),ze.getStartTime();const Ee=N({get:()=>p.viewMode,set:l=>{p.SET_VIEW_MODE(l)}});Ie(()=>p.viewMode,(l,n)=>{l==="bot"&&n==="chat"&&U.path!=="/"&&Be.push("/")});const qe=N(()=>{const l=new Date,n=l.getMonth()+1,s=l.getDate();return n===12&&s===25}),{languageOptions:Ge,currentLanguage:Ra,switchLanguage:Je,locale:Ke}=ct(),Qe=N(()=>Ge.value.map(l=>({code:l.value,name:l.label,flag:l.flag}))),Ze=N(()=>Ke.value),et=async l=>{await Je(l)};return(l,n)=>(u(),_(ht,{elevation:"0",height:"55"},{default:t(()=>[e(p).viewMode==="bot"&&e(H)().uiTheme==="PurpleTheme"?(u(),_(D,{key:0,style:{"margin-left":"16px"},class:"hidden-md-and-down",icon:"",rounded:"sm",variant:"flat",onClick:n[0]||(n[0]=O(s=>e(p).SET_MINI_SIDEBAR(!e(p).mini_sidebar),["stop"]))},{default:t(()=>[a(R,null,{default:t(()=>[d("mdi-menu")]),_:1})]),_:1})):e(p).viewMode==="bot"?(u(),_(D,{key:1,style:{"margin-left":"22px"},class:"hidden-md-and-down",icon:"",rounded:"sm",variant:"flat",onClick:n[1]||(n[1]=O(s=>e(p).SET_MINI_SIDEBAR(!e(p).mini_sidebar),["stop"]))},{default:t(()=>[a(R,null,{default:t(()=>[d("mdi-menu")]),_:1})]),_:1})):C("",!0),e(p).viewMode==="bot"&&e(H)().uiTheme==="PurpleTheme"?(u(),_(D,{key:2,class:"hidden-lg-and-up ms-3",icon:"",rounded:"sm",variant:"flat",onClick:O(e(p).SET_SIDEBAR_DRAWER,["stop"])},{default:t(()=>[a(R,null,{default:t(()=>[d("mdi-menu")]),_:1})]),_:1},8,["onClick"])):e(p).viewMode==="bot"?(u(),_(D,{key:3,class:"hidden-lg-and-up ms-3",icon:"",rounded:"sm",variant:"flat",onClick:O(e(p).SET_SIDEBAR_DRAWER,["stop"])},{default:t(()=>[a(R,null,{default:t(()=>[d("mdi-menu")]),_:1})]),_:1},8,["onClick"])):C("",!0),r("div",{class:oe(["logo-container",{"mobile-logo":l.$vuetify.display.xs,"chat-mode-logo":e(p).viewMode==="chat"}]),onClick:je},[r("span",oa,[d("Astr"),r("span",la,[d("Bot "),qe.value?(u(),z("img",na)):C("",!0)])]),e(p).viewMode==="chat"?(u(),z("span",sa,"ChatUI")):C("",!0),r("span",ia,i(e(V)),1)],2),a(re),r("div",ra,[e(j)?(u(),z("small",da,i(e(o)("core.header.version.hasNewVersion")),1)):e(x)?(u(),z("small",ua,i(e(o)("core.header.version.dashboardHasNewVersion")),1)):C("",!0)]),a(mt,{modelValue:Ee.value,"onUpdate:modelValue":n[2]||(n[2]=s=>Ee.value=s),mandatory:"",variant:"outlined",density:"compact",class:"mr-4",color:"primary"},{default:t(()=>[a(D,{value:"bot",size:"small"},{default:t(()=>[a(R,{start:""},{default:t(()=>[d("mdi-robot")]),_:1}),d(" Bot ")]),_:1}),a(D,{value:"chat",size:"small"},{default:t(()=>[a(R,{start:""},{default:t(()=>[d("mdi-chat")]),_:1}),d(" Chat ")]),_:1})]),_:1},8,["modelValue"]),a(Dt,{offset:"12",location:"bottom end"},{activator:t(({props:s})=>[a(D,Se(s,{size:"small",class:"action-btn mr-4",color:"var(--v-theme-surface)",variant:"flat",rounded:"sm",icon:""}),{default:t(()=>[a(R,null,{default:t(()=>[d("mdi-dots-vertical")]),_:1})]),_:2},1040)]),default:t(()=>[(u(!0),z(ye,null,Le(Qe.value,s=>(u(),_(J,{key:s.code,value:s.code,onClick:G=>et(s.code),class:oe([{"styled-menu-item-active":Ze.value===s.code},"styled-menu-item"]),rounded:"md"},{prepend:t(()=>[r("span",ca,i(s.flag),1)]),default:t(()=>[a(ae,null,{default:t(()=>[d(i(s.name),1)]),_:2},1024)]),_:2},1032,["value","onClick","class"]))),128)),a(J,{onClick:n[3]||(n[3]=s=>we()),class:"styled-menu-item",rounded:"md"},{prepend:t(()=>[a(R,null,{default:t(()=>[d(i(e(H)().uiTheme==="PurpleThemeDark"?"mdi-weather-night":"mdi-white-balance-sunny"),1)]),_:1})]),default:t(()=>[a(ae,null,{default:t(()=>[d(i(e(H)().uiTheme==="PurpleThemeDark"?e(o)("core.header.buttons.theme.light"):e(o)("core.header.buttons.theme.dark")),1)]),_:1})]),_:1}),a(J,{onClick:n[4]||(n[4]=s=>{L(),W(),A(f)?f.value=!0:f=!0}),class:"styled-menu-item",rounded:"md"},Te({prepend:t(()=>[a(R,null,{default:t(()=>[d("mdi-arrow-up-circle")]),_:1})]),default:t(()=>[a(ae,null,{default:t(()=>[d(i(e(o)("core.header.updateDialog.title")),1)]),_:1})]),_:2},[e(j)||e(x)?{name:"append",fn:t(()=>[a(ue,{size:"x-small",color:"primary",variant:"tonal",class:"ml-2"},{default:t(()=>[d("!")]),_:1})]),key:"0"}:void 0]),1024),a(J,{onClick:n[5]||(n[5]=s=>A(h)?h.value=!0:h=!0),class:"styled-menu-item",rounded:"md"},{prepend:t(()=>[a(R,null,{default:t(()=>[d("mdi-account")]),_:1})]),default:t(()=>[a(ae,null,{default:t(()=>[d(i(e(o)("core.header.accountDialog.title")),1)]),_:1})]),_:1})]),_:1}),a(de,{modelValue:e(f),"onUpdate:modelValue":n[9]||(n[9]=s=>A(f)?f.value=s:f=s),width:l.$vuetify.display.smAndDown?"100%":"1200",fullscreen:l.$vuetify.display.xs},{default:t(()=>[a(ne,null,{default:t(()=>[a(De,{class:"mobile-card-title"},{default:t(()=>[r("span",ma,i(e(o)("core.header.updateDialog.title")),1),l.$vuetify.display.xs?(u(),_(D,{key:0,icon:"",onClick:n[6]||(n[6]=s=>A(f)?f.value=!1:f=!1)},{default:t(()=>[a(R,null,{default:t(()=>[d("mdi-close")]),_:1})]),_:1})):C("",!0)]),_:1}),a(se,null,{default:t(()=>[a(Fe,null,{default:t(()=>[pt(a(Xe,{class:"mb-4",indeterminate:"",color:"primary"},null,512),[[vt,e(q)]]),r("div",null,[r("h1",pa,i(e(V)),1),r("small",va,i(e(E)),1)]),e(Y)?(u(),z("div",ga,[a(e(Ce),{content:e(Y),typewriter:!1,class:"markdown-content"},null,8,["content"])])):C("",!0),r("div",fa,[r("small",null,i(e(o)("core.header.updateDialog.tip"))+" "+i(e(o)("core.header.updateDialog.tipContinue")),1)]),r("div",null,[r("div",ha,[r("small",null,[d(i(e(o)("core.header.updateDialog.dockerTip"))+" ",1),r("a",_a,i(e(o)("core.header.updateDialog.dockerTipLink")),1),d(" "+i(e(o)("core.header.updateDialog.dockerTipContinue")),1)])]),e(P).some(s=>fe(s.tag_name))?(u(),_(ie,{key:0,type:"warning",variant:"tonal",border:"start"},{prepend:t(()=>[a(R,null,{default:t(()=>[d("mdi-alert-circle-outline")]),_:1})]),default:t(()=>[r("div",ya,[r("strong",null,i(e(o)("core.header.updateDialog.preReleaseWarning.title")),1),ba,d(" "+i(e(o)("core.header.updateDialog.preReleaseWarning.description"))+" ",1),r("a",wa,i(e(o)("core.header.updateDialog.preReleaseWarning.issueLink")),1)])]),_:1})):C("",!0),a(gt,{headers:pe.value,items:e(P),"item-key":"name","items-per-page":8},{"item.tag_name":t(({item:s})=>[r("div",xa,[r("span",null,i(s.tag_name),1),fe(s.tag_name)?(u(),_(ue,{key:0,size:"x-small",color:"warning",variant:"tonal",class:"ml-2"},{default:t(()=>[d(i(e(o)("core.header.updateDialog.preRelease")),1)]),_:1})):C("",!0)])]),"item.body":t(({item:s})=>[a(D,{onClick:G=>xe(s.body,s.tag_name),rounded:"xl",variant:"tonal",color:"primary",size:"x-small"},{default:t(()=>[d(i(e(o)("core.header.updateDialog.table.view")),1)]),_:2},1032,["onClick"])]),"item.switch":t(({item:s})=>[a(D,{onClick:G=>te(s.tag_name),rounded:"xl",variant:"plain",color:"primary"},{default:t(()=>[d(i(e(o)("core.header.updateDialog.table.switch")),1)]),_:2},1032,["onClick"])]),_:1},8,["headers","items"])]),a(Re,{class:"mt-4 mb-4"}),r("div",ka,[r("h3",Va,i(e(o)("core.header.updateDialog.dashboardUpdate.title")),1),r("div",Da,[r("small",null,i(e(o)("core.header.updateDialog.dashboardUpdate.currentVersion"))+" "+i(e(b)),1),Ca]),r("div",Sa,[e(x)?(u(),z("p",La,i(e(o)("core.header.updateDialog.dashboardUpdate.hasNewVersion")),1)):(u(),z("p",Ta,i(e(o)("core.header.updateDialog.dashboardUpdate.isLatest")),1))]),a(D,{color:"primary",style:{"border-radius":"10px"},onClick:n[7]||(n[7]=s=>be()),disabled:!e(x),loading:e(X)},{default:t(()=>[d(i(e(o)("core.header.updateDialog.dashboardUpdate.downloadAndUpdate")),1)]),_:1},8,["disabled","loading"])])]),_:1})]),_:1}),a(_e,null,{default:t(()=>[a(re),a(D,{color:"blue-darken-1",variant:"text",onClick:n[8]||(n[8]=s=>A(f)?f.value=!1:f=!1)},{default:t(()=>[d(i(e(o)("core.common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","width","fullscreen"]),a(de,{modelValue:e(I),"onUpdate:modelValue":n[11]||(n[11]=s=>A(I)?I.value=s:I=s),"max-width":"800"},{default:t(()=>[a(ne,null,{default:t(()=>[a(De,{class:"text-h5"},{default:t(()=>[d(i(e(o)("core.header.updateDialog.releaseNotes.title"))+": "+i(e(me)),1)]),_:1}),a(se,{style:{"font-size":"14px","max-height":"400px","overflow-y":"auto"}},{default:t(()=>[a(e(Ce),{content:e(le),typewriter:!1,class:"markdown-content"},null,8,["content"])]),_:1}),a(_e,null,{default:t(()=>[a(re),a(D,{color:"blue-darken-1",variant:"text",onClick:n[10]||(n[10]=s=>A(I)?I.value=!1:I=!1)},{default:t(()=>[d(i(e(o)("core.common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(de,{modelValue:e(h),"onUpdate:modelValue":n[19]||(n[19]=s=>A(h)?h.value=s:h=s),persistent:"","max-width":l.$vuetify.display.xs?"90%":"500"},{default:t(()=>[a(ne,{class:"account-dialog"},{default:t(()=>[a(se,{class:"py-6"},{default:t(()=>[r("div",Ia,[a(aa,{title:e(o)("core.header.logoTitle"),subtitle:e(o)("core.header.accountDialog.title")},null,8,["title","subtitle"])]),e(S)?(u(),_(ie,{key:0,type:"warning",variant:"tonal",border:"start",class:"mb-4"},{default:t(()=>[r("strong",null,i(e(o)("core.header.accountDialog.securityWarning")),1)]),_:1})):C("",!0),$.value.success?(u(),_(ie,{key:1,type:"success",variant:"tonal",border:"start",class:"mb-4"},{default:t(()=>[d(i($.value.message),1)]),_:1})):C("",!0),$.value.error?(u(),_(ie,{key:2,type:"error",variant:"tonal",border:"start",class:"mb-4"},{default:t(()=>[d(i($.value.message),1)]),_:1})):C("",!0),a(ft,{modelValue:Q.value,"onUpdate:modelValue":n[17]||(n[17]=s=>Q.value=s),onSubmit:O(g,["prevent"])},{default:t(()=>[a(ke,{modelValue:e(y),"onUpdate:modelValue":n[12]||(n[12]=s=>A(y)?y.value=s:y=s),"append-inner-icon":Z.value?"mdi-eye-off":"mdi-eye",type:Z.value?"text":"password",label:e(o)("core.header.accountDialog.form.currentPassword"),variant:"outlined",required:"",clearable:"","onClick:appendInner":n[13]||(n[13]=s=>Z.value=!Z.value),"prepend-inner-icon":"mdi-lock-outline","hide-details":"auto",class:"mb-4"},null,8,["modelValue","append-inner-icon","type","label"]),a(ke,{modelValue:e(T),"onUpdate:modelValue":n[14]||(n[14]=s=>A(T)?T.value=s:T=s),"append-inner-icon":ee.value?"mdi-eye-off":"mdi-eye",type:ee.value?"text":"password",rules:ve.value,label:e(o)("core.header.accountDialog.form.newPassword"),variant:"outlined",required:"",clearable:"","onClick:appendInner":n[15]||(n[15]=s=>ee.value=!ee.value),"prepend-inner-icon":"mdi-lock-plus-outline",hint:e(o)("core.header.accountDialog.form.passwordHint"),"persistent-hint":"",class:"mb-4"},null,8,["modelValue","append-inner-icon","type","rules","label","hint"]),a(ke,{modelValue:e(B),"onUpdate:modelValue":n[16]||(n[16]=s=>A(B)?B.value=s:B=s),rules:ge.value,label:e(o)("core.header.accountDialog.form.newUsername"),variant:"outlined",clearable:"","prepend-inner-icon":"mdi-account-edit-outline",hint:e(o)("core.header.accountDialog.form.usernameHint"),"persistent-hint":"",class:"mb-3"},null,8,["modelValue","rules","label","hint"])]),_:1},8,["modelValue","onSubmit"]),r("div",Ma,i(e(o)("core.header.accountDialog.form.defaultCredentials")),1)]),_:1}),a(Re),a(_e,{class:"pa-4"},{default:t(()=>[a(re),e(S)?C("",!0):(u(),_(D,{key:0,variant:"tonal",color:"secondary",onClick:n[18]||(n[18]=s=>A(h)?h.value=!1:h=!1),disabled:$.value.loading},{default:t(()=>[d(i(e(o)("core.header.accountDialog.actions.cancel")),1)]),_:1},8,["disabled"])),a(D,{color:"primary",onClick:g,loading:$.value.loading,disabled:!Q.value,"prepend-icon":"mdi-content-save"},{default:t(()=>[d(i(e(o)("core.header.accountDialog.actions.save")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue","max-width"]),a(de,{modelValue:e(w),"onUpdate:modelValue":n[20]||(n[20]=s=>A(w)?w.value=s:w=s),width:"600"},{default:t(()=>[a(ne,null,{default:t(()=>[a(se,{style:{"overflow-y":"auto"}},{default:t(()=>[a(Ct)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});const za={key:0,style:{height:"100%",width:"100%",overflow:"hidden"}},Ea=Me({__name:"FullLayout",setup(m){const p=H(),M=He(),o=_t(),U=N(()=>M.path.startsWith("/chat")),h=N(()=>p.viewMode==="bot"),S=N(()=>p.viewMode==="chat"),f=c(null),w=async()=>{try{const k=await F.get("/api/stat/version");if(k.data.status==="ok"&&k.data.data.need_migration&&f.value&&typeof f.value.open=="function"){const y=await f.value.open();y.success&&(console.log("Migration completed successfully:",y.message),window.location.reload())}}catch(k){console.error("Failed to check migration status:",k)}};return Ne(()=>{setTimeout(w,1e3)}),(k,y)=>(u(),_(xt,null,{default:t(()=>[a(wt,{theme:e(H)().uiTheme,class:oe([e(p).fontTheme,e(p).mini_sidebar?"mini-sidebar":"",e(p).inputBg?"inputWithbg":""])},{default:t(()=>[e(o).isLoading?(u(),_(Xe,{key:0,"model-value":e(o).progress,color:"primary",height:"2",fixed:"",top:"",style:{"z-index":"9999",position:"absolute",opacity:"0.3"}},null,8,["model-value"])):C("",!0),a($a),h.value?(u(),_(Yt,{key:1})):C("",!0),a(yt,{style:K({height:S.value?"calc(100vh - 55px)":void 0,overflow:S.value?"hidden":void 0})},{default:t(()=>[a(Fe,{fluid:"",class:oe(["page-wrapper",{"chat-mode-container":S.value}]),style:K({height:S.value?"100%":"calc(100% - 8px)",padding:U.value||S.value?"0":void 0,minHeight:S.value?"unset":void 0})},{default:t(()=>[r("div",{style:K({height:"100%",width:"100%",overflow:S.value?"hidden":void 0})},[S.value?(u(),z("div",za,[a(St)])):(u(),_(e(bt),{key:1}))],4)]),_:1},8,["class","style"])]),_:1},8,["style"]),a(kt,{ref_key:"migrationDialog",ref:f},null,512)]),_:1},8,["theme","class"])]),_:1}))}});const Za=$e(Ea,[["__scopeId","data-v-b6e03128"]]);export{Za as default};
