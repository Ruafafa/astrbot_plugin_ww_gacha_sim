![astrbot_plugin_ww_gacha_sim](https://socialify.git.ci/Ruafafa/astrbot_plugin_ww_gacha_sim/image?custom_description=%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8EAstrBot%E7%9A%84%E9%B8%A3%E6%BD%AE%E6%A8%A1%E6%8B%9F%E6%8A%BD%E5%8D%A1%E6%8F%92%E4%BB%B6%EF%BC%8C&description=1&forks=1&issues=1&language=1&name=1&stargazers=1&theme=Light)

# ğŸ”–WW_GACHA_SIM

## åŠŸèƒ½ç‰¹ç‚¹

- âœ… æ¨¡æ‹Ÿå•æŠ½å’Œåè¿æŠ½
- âœ… è‡ªå®šä¹‰å¡æ± ç‰©å“ã€æ¦‚ç‡é…ç½®
- âœ… æ”¯æŒé€šè¿‡WEBUIå¯è§†åŒ–ç¼–å†™å¡æ± é…ç½®æ–‡ä»¶
- âœ… å†å²æŠ½å¡è®°å½•æŸ¥è¯¢
- âœ… æŠ½å¡çŠ¶æ€æŒä¹…åŒ–ä¿å­˜

## å®‰è£…æ’ä»¶

1. è‡ªåŠ¨å®‰è£…
é€šè¿‡AstrBotä»ªè¡¨æ¿å®‰è£…æ’ä»¶ï¼Œæœç´¢`astrbot_plugin_ww_gacha_sim`

2. æ‰‹åŠ¨å®‰è£…
å‰å¾€`AstrBot\data\plugins`ç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æˆ–ä¸‹è½½ä»“åº“ä¸»åˆ†æ”¯æºä»£ç åè§£å‹åˆ°è¯¥ç›®å½•
```bash
git clone https://github.com/Ruafafa/astrbot_plugin_ww_gacha_sim.git ./data/plugins/astrbot_plugin_ww_gacha_sim
```
### æ’ä»¶è®¾ç½®

é€šè¿‡AstrBotä»ªè¡¨æ¿è°ƒæ•´æ’ä»¶é…ç½®ï¼š

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `enable_rendering` | bool | `true` | æ˜¯å¦å¼€å¯æ¸²æŸ“åŠŸèƒ½ï¼Œå¯ç”¨æˆ–ç¦ç”¨æŠ½å¡ç»“æœçš„å›¾ç‰‡æ¸²æŸ“ |
| `save_rendered_results` | bool | `false` | æ˜¯å¦å°†æ¸²æŸ“çš„æŠ½å¡ç»“æœå›¾ç‰‡ä¿å­˜åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ |
| `config_storage_path` | string | `./card_pool_configs` | å¡æ± é…ç½®æ–‡ä»¶çš„å­˜å‚¨ç›®å½•è·¯å¾„ |
| `render_output_path` | string | `./rendered_results` | æŠ½å¡ç»“æœå›¾ç‰‡çš„ä¿å­˜ç›®å½•è·¯å¾„ |
| `cache_cleanup_interval` | int | `24` | èµ„æºç¼“å­˜è‡ªåŠ¨æ¸…ç†çš„æ—¶é—´é—´éš”ï¼ˆå•ä½ï¼šå°æ—¶ï¼‰ï¼ŒèŒƒå›´1-720 |
| `enable_history_recording` | bool | `true` | æ˜¯å¦ä¿å­˜ç”¨æˆ·çš„æŠ½å¡å†å²è®°å½• |
| `proxy_url` | string | `""` | ç½‘ç»œä»£ç†åœ°å€|

## åŠŸèƒ½åˆ—è¡¨

è¯·ä½¿ç”¨ `/å¡æ± ` è·å–æ‰€æœ‰å¯ç”¨å¡æ± 

### åŸºç¡€æŒ‡ä»¤
| æŒ‡ä»¤ | åˆ«å | åŠŸèƒ½ |
|------|------|------|
| `/å¡æ± ` | `/å¡æ± åˆ—è¡¨` `/æŸ¥çœ‹å¡æ± ` | æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å¡æ±  |
| `/å”¤å– <å¡æ± ID/åç§°>` | `/é€‰æŠ½` `/è®¾ç½®å¡æ± ` `/é€‰æ‹©å¡æ± ` | è®¾ç½®é»˜è®¤å¡æ±  |
| `/å•æŠ½ <å¡æ± ID/åç§°>` | `/å•æ¬¡æŠ½å¡` | æ‰§è¡Œå•æ¬¡æŠ½å¡ |
| `/åæŠ½ <å¡æ± ID/åç§°>` | `/åè¿` `/10æŠ½` `/10è¿` | æ‰§è¡Œåè¿æŠ½ |
| `/æŠ½å¡è®°å½• <å¡æ± ID/åç§°>` | `/å†å²è®°å½•` `/æŸ¥çœ‹æŠ½å¡` `/æŠ½å¡å†å²` | æŸ¥çœ‹å†å²æŠ½å¡è®°å½• |
| `/å¡æ± è¯¦ç»† <å¡æ± ID/åç§°>` | `/æŸ¥çœ‹å¡æ± è¯¦ç»†` `/å¡æ± è¯¦æƒ…` | æŸ¥çœ‹æŒ‡å®šå¡æ± çš„è¯¦ç»†é…ç½® |

### æŒ‡ä»¤æ¼”ç¤º

`/å¡æ± `

![alt text](.github/image/cp.png)

`/å”¤å– <å¡æ± ID/åç§°>`

![alt text](.github/image/gache_set.png)

`/å•æŠ½`

![alt text](.github/image/single.png)

`/åæŠ½`

![alt text](.github/image/ten.png)

`/æŠ½å¡è®°å½• <å¡æ± ID/åç§°>`

![alt text](.github/image/history.png)

`/å¡æ± è¯¦ç»† <å¡æ± ID/åç§°>`

![alt text](.github/image/cp_detail.png)

## å¡æ± é…ç½®

### WEBUIå¯åŠ¨

Astrbotè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œåœ¨æ’ä»¶æ ¹ç›®å½•(AstrBot\data\plugins\astrbot_plugin_ww_gacha_sim)ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨WEBUI
```bash
python -m src.web.server 
```
WEBUIé»˜è®¤ç«¯å£ä¸º`5000`ï¼Œé¦–æ¬¡å¯åŠ¨æ’ä»¶æ—¶ä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨è®¿é—®`http://localhost:5000`ï¼Œå¦‚é‡åˆ°ç«¯å£å†²çªå¯ä»¥åœ¨å¯åŠ¨æ—¶æŒ‡å®šä¸åŒç«¯å£ï¼Œä¾‹å¦‚ï¼š
```bash
python -m src.web.server --port 8000
```
> [!WARNING]
> æ³¨æ„ï¼å¡æ± çš„çŠ¶æ€åªä¼šåœ¨æ’ä»¶åŠ è½½æ—¶ç”Ÿæ•ˆï¼Œæ›´æ”¹å¡æ± é…ç½®æ–‡ä»¶åè¯·é‡è½½æ’ä»¶ä»¥ç¡®ä¿é…ç½®ç”Ÿæ•ˆï¼ï¼ï¼

### å¡æ± é…ç½®ç•Œé¢
WEBUIçš„å¡æ± é…ç½®é¡µé»˜è®¤å±•ç¤º default é…ç½®ç»„ä¸‹çš„æ‰€æœ‰å¡æ± é…ç½®ï¼Œä½ å¯ä»¥é€šè¿‡å·¦ä¸Šè§’çš„é€‰æ‹©é…ç½®ç»„æ¥åˆ‡æ¢ä¸åŒçš„é…ç½®ç»„ï¼Œå¦‚æœä½ æƒ³æ·»åŠ æ–°çš„é…ç½®ç»„ï¼Œåªéœ€è¦åœ¨æ–°å»ºçš„å¡æ± é…ç½®ä¸­æŒ‡å®šæ–°çš„é…ç½®ç»„åç§°å³å¯è‡ªåŠ¨åˆ›å»ºé…ç½®ç»„ã€‚
ä½ å¯ä»¥åœ¨è¯¥ç•Œé¢å¢æ·»ã€åˆ é™¤ã€å¯ç”¨ã€ç¦ç”¨ä¸åŒçš„å¡æ± é…ç½®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç¼–è¾‘JSONæ–‡ä»¶æ¥ä¿®æ”¹å¡æ± é…ç½®ï¼ˆä¸å»ºè®®è¿™æ ·æ“ä½œï¼‰ã€‚
å¡æ± é…ç½®æ–‡ä»¶é»˜è®¤ä½äº `card_pool_configs/` ç›®å½•ä¸‹ï¼Œæ”¯æŒJSONæ ¼å¼
![alt text](.github/image/webui.png)
> [!NOTE]
> è™½ç„¶WEBUIä¸­åªå±•ç¤ºäº†é€‰ä¸­é…ç½®ç»„ä¸‹çš„å¡æ± é…ç½®ï¼Œä½†è¿™ä¸æ„å‘³è€…å…¶ä»–çš„é…ç½®ç»„ä¸‹çš„å¡æ± é…ç½®ä¸ä¼šè¢«ç”¨æˆ·çš„`/å¡æ± `æŒ‡ä»¤å±•ç¤ºï¼Œ**åªæœ‰é€šè¿‡å¯ç”¨ã€ç¦ç”¨å¡æ± é…ç½®ï¼Œæ‰ä¼šåœ¨`/å¡æ± `æŒ‡ä»¤ä¸­é€‰æ‹©å±•ç¤ºã€‚**
> åŒæ—¶ï¼Œ**å¡æ± çš„çŠ¶æ€åªä¼šåœ¨æ’ä»¶åŠ è½½æ—¶ç”Ÿæ•ˆ**ï¼Œå¦‚æœåœ¨æ’ä»¶è¿è¡Œè¿‡ç¨‹ä¸­ä¿®æ”¹äº†å¡æ± çš„çŠ¶æ€ï¼ˆæ¯”å¦‚å¯ç”¨çŠ¶æ€æˆ–è€…æ¦‚ç‡å‚æ•°ï¼‰ï¼Œå¿…é¡»é‡è½½æ’ä»¶åæ‰å¯åº”ç”¨æœ€æ–°çŠ¶æ€ã€‚

### å¡æ± å†…å®¹ç¼–è¾‘
ç‚¹å‡»æŒ‡å®šå¡æ± çš„ç¼–è¾‘æŒ‰é’®ï¼Œå³å¯è¿›å…¥ç¼–è¾‘é¡µé¢ï¼Œè¿™é‡Œæ¶‰åŠåˆ°çš„ç‰©å“ï¼Œå³ä¸ºå¡æ± ä¸­çš„è·å–ç‰©ï¼Œå¦‚è§’è‰²ã€æ­¦å™¨ã€‚ç¼–è¾‘ç•Œé¢çš„å¡æ± é…ç½®è¯´æ˜å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
![alt text](.github/image/edit.png)

### å¡æ± ç‰©å“ç®¡ç†
åœ¨ç¼–è¾‘é¡µé¢ï¼Œä½ å¯ä»¥æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹å¡æ± ä¸­çš„ç‰©å“ã€‚
![alt text](.github/image/items.png)
æ¯ä¸ªç‰©å“éƒ½æœ‰ä»¥ä¸‹å±æ€§ï¼š

- `external_id`ï¼šç‰©å“çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåœ¨å¡æ± é…ç½®ä¸­å¼•ç”¨ç‰©å“ã€‚
- `name ï¼ˆåç§°ï¼‰`ï¼šç‰©å“çš„åç§°ï¼Œç”¨äºæ˜¾ç¤ºåœ¨æŠ½å¡ç»“æœä¸­ã€‚
- `type ï¼ˆç±»å‹ï¼‰`ï¼šç‰©å“çš„ç±»å‹ï¼Œå¦‚è§’è‰²ã€æ­¦å™¨ç­‰ã€‚
- `rarityï¼ˆç¨€æœ‰åº¦ï¼‰`ï¼šç‰©å“çš„ç¨€æœ‰åº¦ï¼Œå¦‚äº”æ˜Ÿã€å››æ˜Ÿç­‰ã€‚
- `affiliated_typeï¼ˆé™„å±ç±»å‹ï¼‰`ï¼šç‰©å“çš„å…³è”ç±»å‹ï¼Œå¦‚å†°ã€å†·å‡ã€‚
- `portrait Pathï¼ˆç«‹ç»˜ï¼‰`ï¼šç‰©å“çš„æ¸²æŸ“æ—¶æ‰€ç”¨ç«‹ç»˜çš„æœ¬åœ°èµ„æºè·¯å¾„
- `portrait URLï¼ˆç«‹ç»˜URLï¼‰`ï¼šç‰©å“çš„æ¸²æŸ“æ—¶æ‰€ç”¨ç«‹ç»˜çš„URL


> [!NOTE]
> ç‰©å“çš„ `external_id` å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä¸èƒ½ä¸å…¶ä»–ç‰©å“é‡å¤ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå„ä¸ªé…ç½®ç»„ä¸‹çš„ç‰©å“åˆ—è¡¨æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œå³ä¸€ä¸ªé…ç½®ç»„ä¸‹çš„ç‰©å“ä¸ä¼šå½±å“åˆ°å…¶ä»–é…ç½®ç»„ä¸‹çš„ç‰©å“ã€‚
åœ¨é¦–æ¬¡ä½¿ç”¨æˆ–åˆ›å»ºé…ç½®ç»„æ—¶ï¼Œå¦‚æœè¯¥é…ç½®ç»„ä¸­æ²¡æœ‰ç‰©å“ï¼Œæ’ä»¶ä¼šè‡ªåŠ¨ä» `default.csv` å¯¼å…¥é»˜è®¤ç‰©å“æ•°æ®ã€‚

> [!WARNING]
> ç”±äºé»˜è®¤çš„default.csvæ–‡ä»¶ä¸­æ²¡æœ‰æä¾›ç«‹ç»˜çš„æœ¬åœ°è·¯å¾„ï¼Œåœ¨å¼€å¯äº†æ¸²æŸ“åŠŸèƒ½åï¼Œç‰©å“çš„ç«‹ç»˜å°†ä»URLä¸­è·å–ã€‚è€Œé»˜è®¤æä¾›çš„URLæ˜¯ä» GITHUB ä¸Šçš„ä»“åº“ `TomyJan/WutheringWaves-UIResources` ä¸­è·å–çš„ï¼Œå›½å†…**å»ºè®®å¼€å¯ç³»ç»Ÿä»£ç†**ï¼Œå¦åˆ™å¯èƒ½ä¼šå› ä¸ºç½‘ç»œé—®é¢˜å¯¼è‡´åŠ è½½å¤±è´¥ã€‚ 
> å¦‚æœæ— æ³•å¼€å¯ç³»ç»Ÿä»£ç†ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨ä¸‹è½½ç‰©å“ç«‹ç»˜å¹¶æŒ‡å®šæœ¬åœ°è·¯å¾„ã€‚å¹¶ç›´æ¥ä¿®æ”¹ç‰©å“çš„ç«‹ç»˜URLä¸ºæœ¬åœ°è·¯å¾„ã€‚
> ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä¸€äº›åŠ é€ŸæœåŠ¡å¦‚ [gh-proxy.com](https://gh-proxy.com/)ï¼Œåœ¨`.csv`æ–‡ä»¶ä¸­æ›¿æ¢åŸæœ‰çš„URLä¸ºåŠ é€Ÿåçš„URLï¼Œé€šè¿‡WEBUIæä¾›çš„å¯¼å…¥csvåŠŸèƒ½ä¸€é”®å¯¼å…¥ã€‚
> è¯·ç¡®ä¿æ‰€æœ‰ç‰©å“çš„ç«‹ç»˜URLéƒ½èƒ½æ­£å¸¸è®¿é—®ï¼Œå¦åˆ™æ¸²æŸ“åŠŸèƒ½å¯èƒ½ä¼šå¤±è´¥ã€‚
  
